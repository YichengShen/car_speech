---

title: 10-fold Cross Validation


keywords: fastai
sidebar: home_sidebar

summary: "Code for training is the same as Notebook 05."
description: "Code for training is the same as Notebook 05."
nb_path: "08_Ten-fold_Cross_Validation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 08_Ten-fold_Cross_Validation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">car_speech.fname_processing</span> <span class="kn">import</span> <span class="n">load_fnames</span>
<span class="kn">from</span> <span class="nn">car_speech.pipeline</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers.experimental</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">KFold</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Configuration">Configuration<a class="anchor-link" href="#Configuration"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATASET_TYPE</span> <span class="o">=</span> <span class="s1">&#39;digits&#39;</span> <span class="c1"># &#39;digits&#39; or &#39;letters&#39; or &#39;mixed&#39;</span>
<span class="n">LEVEL_NAME</span> <span class="o">=</span> <span class="s1">&#39;IDL&#39;</span> <span class="c1"># &#39;IDL&#39; or &#39;35U&#39; or &#39;35D&#39; or &#39;55U&#39; or &#39;55D&#39;</span>

<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;digits&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)])</span>
    <span class="n">fname_str</span> <span class="o">=</span> <span class="s1">&#39;digit&#39;</span>
<span class="k">elif</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;letters&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>
    <span class="n">fname_str</span> <span class="o">=</span> <span class="s1">&#39;letter&#39;</span>
<span class="k">elif</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;mixed&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>
    <span class="n">fname_str</span> <span class="o">=</span> <span class="s1">&#39;mixed&#39;</span>
    
<span class="c1"># load classified filenames</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">load_fnames</span><span class="p">(</span><span class="s1">&#39;noise_levels/&#39;</span> <span class="o">+</span> <span class="n">fname_str</span> <span class="o">+</span> <span class="s1">&#39;_noise_levels/&#39;</span> <span class="o">+</span> <span class="n">LEVEL_NAME</span> <span class="o">+</span> <span class="s1">&#39;.data&#39;</span><span class="p">)</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of files:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">))</span>

<span class="c1"># shuffle</span>
<span class="n">shuffle</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>

<span class="n">fold_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">acc_per_fold</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of files: 2677
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loop-for-10-fold">Loop for 10-fold<a class="anchor-link" href="#Loop-for-10-fold"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beg_ratio</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">beg_ratio</span> <span class="o">&lt;</span> <span class="mf">0.9</span><span class="p">:</span>
    <span class="n">test_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">beg_ratio</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="n">test_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">beg_ratio</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    
    <span class="n">fnames_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    
    <span class="n">val_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">fnames_copy</span>
    
    <span class="n">beg_ratio</span> <span class="o">+=</span> <span class="mf">0.1</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">train_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">val_files</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    

    <span class="c1"># Process data using the combined pipeline</span>
    <span class="n">spectrogram_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">train_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">spectrogram_ds</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">val_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">test_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">test_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pipeline Completed&quot;</span><span class="p">)</span>
    
    <span class="c1"># batch</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    
    <span class="n">AUTOTUNE</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    
    <span class="c1"># model</span>
    <span class="k">for</span> <span class="n">spectrogram</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">spectrogram</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">#     print(&#39;Input shape:&#39;, input_shape)</span>
    <span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_strings</span><span class="p">)</span>

    <span class="n">norm_layer</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">Normalization</span><span class="p">()</span>
    <span class="n">norm_layer</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">x</span><span class="p">))</span>

<span class="c1">#     model = models.Sequential([</span>
<span class="c1">#         layers.Input(shape=input_shape),</span>
<span class="c1">#         preprocessing.Resizing(32, 32), </span>
<span class="c1">#         norm_layer,</span>
<span class="c1">#         layers.Conv2D(32, 3, activation=&#39;relu&#39;),</span>
<span class="c1">#         layers.Conv2D(64, 3, activation=&#39;relu&#39;),</span>
<span class="c1">#         layers.MaxPooling2D(),</span>
<span class="c1">#         layers.Dropout(0.25),</span>
<span class="c1">#         layers.Flatten(),</span>
<span class="c1">#         layers.Dense(128, activation=&#39;relu&#39;),</span>
<span class="c1">#         layers.Dropout(0.5),</span>
<span class="c1">#         layers.Dense(num_labels),</span>
<span class="c1">#     ])</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">),</span>
        <span class="n">preprocessing</span><span class="o">.</span><span class="n">Resizing</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> 
        <span class="n">norm_layer</span><span class="p">,</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_labels</span><span class="p">),</span>
    <span class="p">])</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span>
    <span class="p">)</span>
    
    <span class="c1"># Train</span>
    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_ds</span><span class="p">,</span> 
        <span class="n">validation_data</span><span class="o">=</span><span class="n">val_ds</span><span class="p">,</span>  
        <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">test_audio</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">audio</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">test_ds</span><span class="p">:</span>
        <span class="n">test_audio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        <span class="n">test_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

    <span class="n">test_audio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_audio</span><span class="p">)</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_audio</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">test_labels</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fold </span><span class="si">{</span><span class="n">fold_no</span><span class="si">}</span><span class="s1"> - Test set accuracy: </span><span class="si">{</span><span class="n">test_acc</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">acc_per_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">test_acc</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">fold_no</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline Completed
Epoch 1/100
34/34 [==============================] - 6s 174ms/step - loss: 3.2555 - accuracy: 0.0532 - val_loss: 3.2160 - val_accuracy: 0.0487
Epoch 2/100
34/34 [==============================] - 4s 132ms/step - loss: 3.1845 - accuracy: 0.0700 - val_loss: 3.0995 - val_accuracy: 0.0787
Epoch 3/100
34/34 [==============================] - 4s 125ms/step - loss: 3.0935 - accuracy: 0.0849 - val_loss: 3.0073 - val_accuracy: 0.0974
Epoch 4/100
34/34 [==============================] - 4s 126ms/step - loss: 3.0126 - accuracy: 0.0980 - val_loss: 2.9042 - val_accuracy: 0.1199
Epoch 5/100
34/34 [==============================] - 4s 118ms/step - loss: 2.9480 - accuracy: 0.1134 - val_loss: 2.7988 - val_accuracy: 0.1386
Epoch 6/100
34/34 [==============================] - 5s 134ms/step - loss: 2.8675 - accuracy: 0.1321 - val_loss: 2.7338 - val_accuracy: 0.1536
Epoch 7/100
34/34 [==============================] - 5s 139ms/step - loss: 2.7600 - accuracy: 0.1475 - val_loss: 2.6301 - val_accuracy: 0.1723
Epoch 8/100
34/34 [==============================] - 4s 132ms/step - loss: 2.6644 - accuracy: 0.1727 - val_loss: 2.5235 - val_accuracy: 0.1835
Epoch 9/100
34/34 [==============================] - 5s 155ms/step - loss: 2.5892 - accuracy: 0.1913 - val_loss: 2.4457 - val_accuracy: 0.2547
Epoch 10/100
34/34 [==============================] - 5s 135ms/step - loss: 2.4967 - accuracy: 0.2142 - val_loss: 2.3813 - val_accuracy: 0.2434
Epoch 11/100
34/34 [==============================] - 5s 133ms/step - loss: 2.3975 - accuracy: 0.2408 - val_loss: 2.2852 - val_accuracy: 0.2547
Epoch 12/100
34/34 [==============================] - 4s 126ms/step - loss: 2.3294 - accuracy: 0.2552 - val_loss: 2.2137 - val_accuracy: 0.2959
Epoch 13/100
34/34 [==============================] - 4s 126ms/step - loss: 2.2316 - accuracy: 0.2800 - val_loss: 2.1292 - val_accuracy: 0.3371
Epoch 14/100
34/34 [==============================] - 4s 129ms/step - loss: 2.1795 - accuracy: 0.3056 - val_loss: 2.0842 - val_accuracy: 0.3521
Epoch 15/100
34/34 [==============================] - 6s 167ms/step - loss: 2.1368 - accuracy: 0.2907 - val_loss: 2.0203 - val_accuracy: 0.3296
Epoch 16/100
34/34 [==============================] - 5s 154ms/step - loss: 2.0308 - accuracy: 0.3308 - val_loss: 1.9655 - val_accuracy: 0.3745
Epoch 17/100
34/34 [==============================] - 5s 140ms/step - loss: 1.9703 - accuracy: 0.3537 - val_loss: 1.9107 - val_accuracy: 0.3596
Epoch 18/100
34/34 [==============================] - 5s 133ms/step - loss: 1.9355 - accuracy: 0.3621 - val_loss: 1.8525 - val_accuracy: 0.3933
Epoch 19/100
34/34 [==============================] - 4s 131ms/step - loss: 1.8588 - accuracy: 0.3682 - val_loss: 1.8453 - val_accuracy: 0.3670
Epoch 20/100
34/34 [==============================] - 4s 130ms/step - loss: 1.8340 - accuracy: 0.3803 - val_loss: 1.8238 - val_accuracy: 0.4232
Epoch 21/100
34/34 [==============================] - 5s 135ms/step - loss: 1.7585 - accuracy: 0.4106 - val_loss: 1.7902 - val_accuracy: 0.3970
Epoch 22/100
34/34 [==============================] - 5s 159ms/step - loss: 1.7125 - accuracy: 0.4195 - val_loss: 1.7775 - val_accuracy: 0.3745
Epoch 23/100
34/34 [==============================] - 4s 123ms/step - loss: 1.6946 - accuracy: 0.4172 - val_loss: 1.7812 - val_accuracy: 0.3858
Epoch 24/100
34/34 [==============================] - 4s 121ms/step - loss: 1.6298 - accuracy: 0.4615 - val_loss: 1.7240 - val_accuracy: 0.4270
Epoch 25/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6198 - accuracy: 0.4400 - val_loss: 1.7368 - val_accuracy: 0.4457
Epoch 26/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5914 - accuracy: 0.4503 - val_loss: 1.7227 - val_accuracy: 0.4345
Epoch 27/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5609 - accuracy: 0.4666 - val_loss: 1.6887 - val_accuracy: 0.4270
Epoch 28/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5584 - accuracy: 0.4666 - val_loss: 1.7066 - val_accuracy: 0.3970
Epoch 29/100
34/34 [==============================] - 5s 138ms/step - loss: 1.4817 - accuracy: 0.4830 - val_loss: 1.6624 - val_accuracy: 0.4382
Epoch 30/100
34/34 [==============================] - 5s 150ms/step - loss: 1.4239 - accuracy: 0.5114 - val_loss: 1.6534 - val_accuracy: 0.4232
Epoch 31/100
34/34 [==============================] - 5s 148ms/step - loss: 1.4353 - accuracy: 0.5058 - val_loss: 1.6566 - val_accuracy: 0.4270
Epoch 32/100
34/34 [==============================] - 4s 130ms/step - loss: 1.4179 - accuracy: 0.5147 - val_loss: 1.6464 - val_accuracy: 0.4419
Epoch 33/100
34/34 [==============================] - 4s 130ms/step - loss: 1.3836 - accuracy: 0.5245 - val_loss: 1.6141 - val_accuracy: 0.4494
Epoch 34/100
34/34 [==============================] - 4s 131ms/step - loss: 1.3350 - accuracy: 0.5296 - val_loss: 1.5975 - val_accuracy: 0.4419
Epoch 35/100
34/34 [==============================] - 4s 132ms/step - loss: 1.3630 - accuracy: 0.5226 - val_loss: 1.6118 - val_accuracy: 0.4494
Epoch 36/100
34/34 [==============================] - 5s 160ms/step - loss: 1.3185 - accuracy: 0.5362 - val_loss: 1.6292 - val_accuracy: 0.4494
Epoch 37/100
34/34 [==============================] - 5s 144ms/step - loss: 1.3006 - accuracy: 0.5474 - val_loss: 1.6150 - val_accuracy: 0.4345
Epoch 00037: early stopping
Fold 1 - Test set accuracy: 48%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 157ms/step - loss: 3.2635 - accuracy: 0.0369 - val_loss: 3.2337 - val_accuracy: 0.0448
Epoch 2/100
34/34 [==============================] - 4s 115ms/step - loss: 3.1923 - accuracy: 0.0570 - val_loss: 3.0986 - val_accuracy: 0.0672
Epoch 3/100
34/34 [==============================] - 4s 125ms/step - loss: 3.0993 - accuracy: 0.0887 - val_loss: 2.9721 - val_accuracy: 0.0970
Epoch 4/100
34/34 [==============================] - 4s 125ms/step - loss: 2.9987 - accuracy: 0.0986 - val_loss: 2.8529 - val_accuracy: 0.1343
Epoch 5/100
34/34 [==============================] - 4s 130ms/step - loss: 2.9297 - accuracy: 0.1191 - val_loss: 2.7741 - val_accuracy: 0.1269
Epoch 6/100
34/34 [==============================] - 4s 131ms/step - loss: 2.8765 - accuracy: 0.1177 - val_loss: 2.7424 - val_accuracy: 0.1791
Epoch 7/100
34/34 [==============================] - 4s 127ms/step - loss: 2.7730 - accuracy: 0.1513 - val_loss: 2.6010 - val_accuracy: 0.1940
Epoch 8/100
34/34 [==============================] - 4s 131ms/step - loss: 2.6788 - accuracy: 0.1803 - val_loss: 2.5227 - val_accuracy: 0.1903
Epoch 9/100
34/34 [==============================] - 5s 135ms/step - loss: 2.5999 - accuracy: 0.1798 - val_loss: 2.5184 - val_accuracy: 0.2127
Epoch 10/100
34/34 [==============================] - 4s 126ms/step - loss: 2.5485 - accuracy: 0.2041 - val_loss: 2.4522 - val_accuracy: 0.2127
Epoch 11/100
34/34 [==============================] - 4s 125ms/step - loss: 2.4187 - accuracy: 0.2261 - val_loss: 2.4272 - val_accuracy: 0.2276
Epoch 12/100
34/34 [==============================] - 4s 131ms/step - loss: 2.3546 - accuracy: 0.2368 - val_loss: 2.2693 - val_accuracy: 0.2463
Epoch 13/100
34/34 [==============================] - 4s 126ms/step - loss: 2.2897 - accuracy: 0.2527 - val_loss: 2.2471 - val_accuracy: 0.2687
Epoch 14/100
34/34 [==============================] - 4s 125ms/step - loss: 2.2315 - accuracy: 0.2723 - val_loss: 2.1794 - val_accuracy: 0.2836
Epoch 15/100
34/34 [==============================] - 4s 128ms/step - loss: 2.1485 - accuracy: 0.3134 - val_loss: 2.1600 - val_accuracy: 0.3097
Epoch 16/100
34/34 [==============================] - 4s 130ms/step - loss: 2.0998 - accuracy: 0.3083 - val_loss: 2.0515 - val_accuracy: 0.3396
Epoch 17/100
34/34 [==============================] - 5s 138ms/step - loss: 2.0497 - accuracy: 0.3185 - val_loss: 2.0302 - val_accuracy: 0.2985
Epoch 18/100
34/34 [==============================] - 4s 125ms/step - loss: 2.0057 - accuracy: 0.3302 - val_loss: 1.9602 - val_accuracy: 0.3358
Epoch 19/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9468 - accuracy: 0.3456 - val_loss: 1.9266 - val_accuracy: 0.3470
Epoch 20/100
34/34 [==============================] - 4s 128ms/step - loss: 1.8912 - accuracy: 0.3699 - val_loss: 1.9168 - val_accuracy: 0.3470
Epoch 21/100
34/34 [==============================] - 4s 126ms/step - loss: 1.8710 - accuracy: 0.3741 - val_loss: 1.8806 - val_accuracy: 0.3694
Epoch 22/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7884 - accuracy: 0.3914 - val_loss: 1.8565 - val_accuracy: 0.3731
Epoch 23/100
34/34 [==============================] - 5s 133ms/step - loss: 1.7474 - accuracy: 0.4101 - val_loss: 1.7856 - val_accuracy: 0.3769
Epoch 24/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7314 - accuracy: 0.4208 - val_loss: 1.8156 - val_accuracy: 0.3881
Epoch 25/100
34/34 [==============================] - 4s 118ms/step - loss: 1.7158 - accuracy: 0.4138 - val_loss: 1.7560 - val_accuracy: 0.4142
Epoch 26/100
34/34 [==============================] - 5s 135ms/step - loss: 1.6849 - accuracy: 0.4162 - val_loss: 1.7770 - val_accuracy: 0.4030
Epoch 27/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6436 - accuracy: 0.4180 - val_loss: 1.7245 - val_accuracy: 0.3918
Epoch 28/100
34/34 [==============================] - 4s 125ms/step - loss: 1.6135 - accuracy: 0.4549 - val_loss: 1.7407 - val_accuracy: 0.4030
Epoch 29/100
34/34 [==============================] - 4s 123ms/step - loss: 1.5815 - accuracy: 0.4507 - val_loss: 1.6988 - val_accuracy: 0.4142
Epoch 30/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5816 - accuracy: 0.4465 - val_loss: 1.7169 - val_accuracy: 0.3843
Epoch 31/100
34/34 [==============================] - 4s 123ms/step - loss: 1.5648 - accuracy: 0.4437 - val_loss: 1.7093 - val_accuracy: 0.4142
Epoch 32/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4998 - accuracy: 0.4787 - val_loss: 1.6692 - val_accuracy: 0.4254
Epoch 33/100
34/34 [==============================] - 4s 125ms/step - loss: 1.4824 - accuracy: 0.4876 - val_loss: 1.6742 - val_accuracy: 0.4142
Epoch 34/100
34/34 [==============================] - 4s 132ms/step - loss: 1.4755 - accuracy: 0.4750 - val_loss: 1.6568 - val_accuracy: 0.4440
Epoch 35/100
34/34 [==============================] - 4s 123ms/step - loss: 1.4196 - accuracy: 0.4881 - val_loss: 1.6952 - val_accuracy: 0.4701
Epoch 36/100
34/34 [==============================] - 4s 125ms/step - loss: 1.3980 - accuracy: 0.5082 - val_loss: 1.6949 - val_accuracy: 0.4478
Epoch 37/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4384 - accuracy: 0.4867 - val_loss: 1.6595 - val_accuracy: 0.4403
Epoch 00037: early stopping
Fold 2 - Test set accuracy: 43%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 160ms/step - loss: 3.2602 - accuracy: 0.0518 - val_loss: 3.2360 - val_accuracy: 0.0634
Epoch 2/100
34/34 [==============================] - 4s 124ms/step - loss: 3.2107 - accuracy: 0.0556 - val_loss: 3.1230 - val_accuracy: 0.0560
Epoch 3/100
34/34 [==============================] - 4s 126ms/step - loss: 3.1349 - accuracy: 0.0757 - val_loss: 3.0136 - val_accuracy: 0.0784
Epoch 4/100
34/34 [==============================] - 4s 127ms/step - loss: 3.0454 - accuracy: 0.0953 - val_loss: 2.8814 - val_accuracy: 0.1045
Epoch 5/100
34/34 [==============================] - 5s 139ms/step - loss: 2.9808 - accuracy: 0.1037 - val_loss: 2.8276 - val_accuracy: 0.1866
Epoch 6/100
34/34 [==============================] - 4s 127ms/step - loss: 2.8531 - accuracy: 0.1284 - val_loss: 2.7055 - val_accuracy: 0.2052
Epoch 7/100
34/34 [==============================] - 4s 127ms/step - loss: 2.7482 - accuracy: 0.1663 - val_loss: 2.5776 - val_accuracy: 0.2463
Epoch 8/100
34/34 [==============================] - 4s 125ms/step - loss: 2.6147 - accuracy: 0.1831 - val_loss: 2.4634 - val_accuracy: 0.2276
Epoch 9/100
34/34 [==============================] - 4s 114ms/step - loss: 2.5217 - accuracy: 0.2032 - val_loss: 2.3525 - val_accuracy: 0.2612
Epoch 10/100
34/34 [==============================] - 4s 114ms/step - loss: 2.4450 - accuracy: 0.2298 - val_loss: 2.2939 - val_accuracy: 0.2836
Epoch 11/100
34/34 [==============================] - 4s 115ms/step - loss: 2.3561 - accuracy: 0.2541 - val_loss: 2.2336 - val_accuracy: 0.2761
Epoch 12/100
34/34 [==============================] - 4s 123ms/step - loss: 2.2535 - accuracy: 0.2774 - val_loss: 2.1523 - val_accuracy: 0.2985
Epoch 13/100
34/34 [==============================] - 4s 125ms/step - loss: 2.1990 - accuracy: 0.2947 - val_loss: 2.0940 - val_accuracy: 0.2948
Epoch 14/100
34/34 [==============================] - 4s 127ms/step - loss: 2.1403 - accuracy: 0.2957 - val_loss: 2.0573 - val_accuracy: 0.2873
Epoch 15/100
34/34 [==============================] - 4s 128ms/step - loss: 2.0688 - accuracy: 0.3139 - val_loss: 1.9646 - val_accuracy: 0.3396
Epoch 16/100
34/34 [==============================] - 4s 125ms/step - loss: 2.0224 - accuracy: 0.3298 - val_loss: 1.9983 - val_accuracy: 0.3619
Epoch 17/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9678 - accuracy: 0.3461 - val_loss: 1.9237 - val_accuracy: 0.3545
Epoch 18/100
34/34 [==============================] - 4s 126ms/step - loss: 1.8881 - accuracy: 0.3723 - val_loss: 1.9198 - val_accuracy: 0.3470
Epoch 19/100
34/34 [==============================] - 4s 127ms/step - loss: 1.8558 - accuracy: 0.3807 - val_loss: 1.8770 - val_accuracy: 0.4030
Epoch 20/100
34/34 [==============================] - 4s 127ms/step - loss: 1.7999 - accuracy: 0.4026 - val_loss: 1.7978 - val_accuracy: 0.3843
Epoch 21/100
34/34 [==============================] - 4s 127ms/step - loss: 1.7794 - accuracy: 0.3984 - val_loss: 1.8096 - val_accuracy: 0.4067
Epoch 22/100
34/34 [==============================] - 4s 119ms/step - loss: 1.7063 - accuracy: 0.4274 - val_loss: 1.7703 - val_accuracy: 0.3806
Epoch 23/100
34/34 [==============================] - 4s 125ms/step - loss: 1.6987 - accuracy: 0.4143 - val_loss: 1.7525 - val_accuracy: 0.3806
Epoch 24/100
34/34 [==============================] - 4s 124ms/step - loss: 1.6355 - accuracy: 0.4418 - val_loss: 1.8045 - val_accuracy: 0.3806
Epoch 25/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6391 - accuracy: 0.4404 - val_loss: 1.7394 - val_accuracy: 0.3955
Epoch 26/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6115 - accuracy: 0.4526 - val_loss: 1.7107 - val_accuracy: 0.4030
Epoch 27/100
34/34 [==============================] - 4s 126ms/step - loss: 1.5514 - accuracy: 0.4657 - val_loss: 1.6656 - val_accuracy: 0.4030
Epoch 28/100
34/34 [==============================] - 4s 126ms/step - loss: 1.5168 - accuracy: 0.4769 - val_loss: 1.7033 - val_accuracy: 0.3769
Epoch 29/100
34/34 [==============================] - 4s 125ms/step - loss: 1.4997 - accuracy: 0.4909 - val_loss: 1.7227 - val_accuracy: 0.3955
Epoch 30/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5125 - accuracy: 0.4839 - val_loss: 1.6730 - val_accuracy: 0.4328
Epoch 00030: early stopping
Fold 3 - Test set accuracy: 40%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 160ms/step - loss: 3.2662 - accuracy: 0.0401 - val_loss: 3.2353 - val_accuracy: 0.0449
Epoch 2/100
34/34 [==============================] - 4s 130ms/step - loss: 3.2135 - accuracy: 0.0574 - val_loss: 3.1285 - val_accuracy: 0.0936
Epoch 3/100
34/34 [==============================] - 5s 133ms/step - loss: 3.1213 - accuracy: 0.0845 - val_loss: 3.0166 - val_accuracy: 0.1199
Epoch 4/100
34/34 [==============================] - 4s 130ms/step - loss: 3.0284 - accuracy: 0.0915 - val_loss: 2.9143 - val_accuracy: 0.1049
Epoch 5/100
34/34 [==============================] - 4s 125ms/step - loss: 2.9587 - accuracy: 0.1008 - val_loss: 2.8404 - val_accuracy: 0.1161
Epoch 6/100
34/34 [==============================] - 4s 129ms/step - loss: 2.8539 - accuracy: 0.1311 - val_loss: 2.7454 - val_accuracy: 0.1536
Epoch 7/100
34/34 [==============================] - 4s 129ms/step - loss: 2.7706 - accuracy: 0.1517 - val_loss: 2.6426 - val_accuracy: 0.1873
Epoch 8/100
34/34 [==============================] - 4s 127ms/step - loss: 2.6930 - accuracy: 0.1671 - val_loss: 2.5384 - val_accuracy: 0.1948
Epoch 9/100
34/34 [==============================] - 4s 132ms/step - loss: 2.6035 - accuracy: 0.1825 - val_loss: 2.4528 - val_accuracy: 0.2584
Epoch 10/100
34/34 [==============================] - 4s 127ms/step - loss: 2.5125 - accuracy: 0.2133 - val_loss: 2.3889 - val_accuracy: 0.2659
Epoch 11/100
34/34 [==============================] - 4s 126ms/step - loss: 2.4191 - accuracy: 0.2287 - val_loss: 2.3631 - val_accuracy: 0.2247
Epoch 12/100
34/34 [==============================] - 4s 125ms/step - loss: 2.3511 - accuracy: 0.2515 - val_loss: 2.3111 - val_accuracy: 0.2584
Epoch 13/100
34/34 [==============================] - 4s 125ms/step - loss: 2.2848 - accuracy: 0.2613 - val_loss: 2.1911 - val_accuracy: 0.2959
Epoch 14/100
34/34 [==============================] - 4s 125ms/step - loss: 2.2069 - accuracy: 0.2912 - val_loss: 2.1609 - val_accuracy: 0.3146
Epoch 15/100
34/34 [==============================] - 4s 126ms/step - loss: 2.1582 - accuracy: 0.2944 - val_loss: 2.1292 - val_accuracy: 0.3184
Epoch 16/100
34/34 [==============================] - 4s 132ms/step - loss: 2.0908 - accuracy: 0.3182 - val_loss: 2.0662 - val_accuracy: 0.3296
Epoch 17/100
34/34 [==============================] - 4s 130ms/step - loss: 2.0343 - accuracy: 0.3271 - val_loss: 2.0863 - val_accuracy: 0.3296
Epoch 18/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9439 - accuracy: 0.3500 - val_loss: 1.9550 - val_accuracy: 0.3670
Epoch 19/100
34/34 [==============================] - 4s 128ms/step - loss: 1.9150 - accuracy: 0.3560 - val_loss: 1.9505 - val_accuracy: 0.3895
Epoch 20/100
34/34 [==============================] - 5s 135ms/step - loss: 1.8709 - accuracy: 0.3724 - val_loss: 1.8893 - val_accuracy: 0.3933
Epoch 21/100
34/34 [==============================] - 4s 132ms/step - loss: 1.8423 - accuracy: 0.3677 - val_loss: 1.8688 - val_accuracy: 0.4007
Epoch 22/100
34/34 [==============================] - 5s 135ms/step - loss: 1.7817 - accuracy: 0.4130 - val_loss: 1.8334 - val_accuracy: 0.4270
Epoch 23/100
34/34 [==============================] - 4s 131ms/step - loss: 1.7333 - accuracy: 0.4167 - val_loss: 1.8058 - val_accuracy: 0.4045
Epoch 24/100
34/34 [==============================] - 4s 130ms/step - loss: 1.7135 - accuracy: 0.4106 - val_loss: 1.7826 - val_accuracy: 0.4045
Epoch 25/100
34/34 [==============================] - 4s 130ms/step - loss: 1.6346 - accuracy: 0.4466 - val_loss: 1.7971 - val_accuracy: 0.3745
Epoch 26/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6292 - accuracy: 0.4372 - val_loss: 1.7454 - val_accuracy: 0.4195
Epoch 27/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5902 - accuracy: 0.4428 - val_loss: 1.7327 - val_accuracy: 0.4270
Epoch 28/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5658 - accuracy: 0.4727 - val_loss: 1.7117 - val_accuracy: 0.4607
Epoch 29/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5208 - accuracy: 0.4764 - val_loss: 1.7288 - val_accuracy: 0.4382
Epoch 30/100
34/34 [==============================] - 5s 133ms/step - loss: 1.5091 - accuracy: 0.4778 - val_loss: 1.7516 - val_accuracy: 0.4120
Epoch 31/100
34/34 [==============================] - 4s 123ms/step - loss: 1.5125 - accuracy: 0.4858 - val_loss: 1.6692 - val_accuracy: 0.4382
Epoch 32/100
34/34 [==============================] - 4s 114ms/step - loss: 1.4878 - accuracy: 0.4760 - val_loss: 1.7314 - val_accuracy: 0.4270
Epoch 33/100
34/34 [==============================] - 4s 115ms/step - loss: 1.4443 - accuracy: 0.5082 - val_loss: 1.6318 - val_accuracy: 0.4644
Epoch 34/100
34/34 [==============================] - 4s 115ms/step - loss: 1.4147 - accuracy: 0.5026 - val_loss: 1.6183 - val_accuracy: 0.4457
Epoch 35/100
34/34 [==============================] - 4s 125ms/step - loss: 1.4106 - accuracy: 0.5091 - val_loss: 1.6358 - val_accuracy: 0.4232
Epoch 36/100
34/34 [==============================] - 4s 126ms/step - loss: 1.3746 - accuracy: 0.5175 - val_loss: 1.6135 - val_accuracy: 0.4419
Epoch 37/100
34/34 [==============================] - 4s 127ms/step - loss: 1.3662 - accuracy: 0.5156 - val_loss: 1.5874 - val_accuracy: 0.4719
Epoch 38/100
34/34 [==============================] - 4s 126ms/step - loss: 1.3179 - accuracy: 0.5404 - val_loss: 1.6342 - val_accuracy: 0.4120
Epoch 39/100
34/34 [==============================] - 4s 125ms/step - loss: 1.2955 - accuracy: 0.5488 - val_loss: 1.5764 - val_accuracy: 0.4494
Epoch 40/100
34/34 [==============================] - 4s 126ms/step - loss: 1.2794 - accuracy: 0.5380 - val_loss: 1.6133 - val_accuracy: 0.4457
Epoch 41/100
34/34 [==============================] - 4s 125ms/step - loss: 1.2385 - accuracy: 0.5791 - val_loss: 1.5526 - val_accuracy: 0.4757
Epoch 42/100
34/34 [==============================] - 4s 131ms/step - loss: 1.2340 - accuracy: 0.5842 - val_loss: 1.6459 - val_accuracy: 0.4120
Epoch 43/100
34/34 [==============================] - 5s 135ms/step - loss: 1.2253 - accuracy: 0.5623 - val_loss: 1.5847 - val_accuracy: 0.4307
Epoch 44/100
34/34 [==============================] - 4s 130ms/step - loss: 1.2301 - accuracy: 0.5702 - val_loss: 1.5877 - val_accuracy: 0.4719
Epoch 00044: early stopping
Fold 4 - Test set accuracy: 43%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 158ms/step - loss: 3.2667 - accuracy: 0.0416 - val_loss: 3.2491 - val_accuracy: 0.0448
Epoch 2/100
34/34 [==============================] - 4s 128ms/step - loss: 3.2231 - accuracy: 0.0589 - val_loss: 3.1538 - val_accuracy: 0.0709
Epoch 3/100
34/34 [==============================] - 4s 126ms/step - loss: 3.1415 - accuracy: 0.0827 - val_loss: 3.0459 - val_accuracy: 0.1157
Epoch 4/100
34/34 [==============================] - 4s 132ms/step - loss: 3.0660 - accuracy: 0.0929 - val_loss: 2.9447 - val_accuracy: 0.1007
Epoch 5/100
34/34 [==============================] - 4s 126ms/step - loss: 2.9917 - accuracy: 0.1210 - val_loss: 2.8372 - val_accuracy: 0.1530
Epoch 6/100
34/34 [==============================] - 4s 129ms/step - loss: 2.8907 - accuracy: 0.1340 - val_loss: 2.7248 - val_accuracy: 0.2052
Epoch 7/100
34/34 [==============================] - 5s 135ms/step - loss: 2.7798 - accuracy: 0.1574 - val_loss: 2.6602 - val_accuracy: 0.2052
Epoch 8/100
34/34 [==============================] - 5s 137ms/step - loss: 2.7025 - accuracy: 0.1677 - val_loss: 2.5903 - val_accuracy: 0.2276
Epoch 9/100
34/34 [==============================] - 4s 128ms/step - loss: 2.5619 - accuracy: 0.2121 - val_loss: 2.4044 - val_accuracy: 0.3022
Epoch 10/100
34/34 [==============================] - 4s 128ms/step - loss: 2.4898 - accuracy: 0.2219 - val_loss: 2.3211 - val_accuracy: 0.2985
Epoch 11/100
34/34 [==============================] - 4s 125ms/step - loss: 2.3639 - accuracy: 0.2401 - val_loss: 2.2142 - val_accuracy: 0.3134
Epoch 12/100
34/34 [==============================] - 5s 133ms/step - loss: 2.2993 - accuracy: 0.2676 - val_loss: 2.1901 - val_accuracy: 0.2985
Epoch 13/100
34/34 [==============================] - 5s 134ms/step - loss: 2.2449 - accuracy: 0.2905 - val_loss: 2.1168 - val_accuracy: 0.3209
Epoch 14/100
34/34 [==============================] - 5s 139ms/step - loss: 2.1605 - accuracy: 0.2999 - val_loss: 1.9910 - val_accuracy: 0.3806
Epoch 15/100
34/34 [==============================] - 4s 128ms/step - loss: 2.0797 - accuracy: 0.3139 - val_loss: 2.0061 - val_accuracy: 0.3209
Epoch 16/100
34/34 [==============================] - 4s 125ms/step - loss: 2.0196 - accuracy: 0.3466 - val_loss: 1.9265 - val_accuracy: 0.3769
Epoch 17/100
34/34 [==============================] - 4s 129ms/step - loss: 1.9776 - accuracy: 0.3391 - val_loss: 1.9193 - val_accuracy: 0.3433
Epoch 18/100
34/34 [==============================] - 4s 127ms/step - loss: 1.9069 - accuracy: 0.3620 - val_loss: 1.8587 - val_accuracy: 0.3769
Epoch 19/100
34/34 [==============================] - 4s 126ms/step - loss: 1.8439 - accuracy: 0.3779 - val_loss: 1.8293 - val_accuracy: 0.3731
Epoch 20/100
34/34 [==============================] - 4s 128ms/step - loss: 1.8149 - accuracy: 0.3895 - val_loss: 1.8029 - val_accuracy: 0.3769
Epoch 21/100
34/34 [==============================] - 4s 126ms/step - loss: 1.8082 - accuracy: 0.3858 - val_loss: 1.7861 - val_accuracy: 0.3918
Epoch 22/100
34/34 [==============================] - 4s 125ms/step - loss: 1.7665 - accuracy: 0.4012 - val_loss: 1.7489 - val_accuracy: 0.4216
Epoch 23/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7138 - accuracy: 0.4213 - val_loss: 1.7137 - val_accuracy: 0.4328
Epoch 24/100
34/34 [==============================] - 4s 123ms/step - loss: 1.6326 - accuracy: 0.4367 - val_loss: 1.7099 - val_accuracy: 0.4291
Epoch 25/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6359 - accuracy: 0.4381 - val_loss: 1.6848 - val_accuracy: 0.4328
Epoch 26/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6062 - accuracy: 0.4675 - val_loss: 1.6807 - val_accuracy: 0.4142
Epoch 27/100
34/34 [==============================] - 4s 126ms/step - loss: 1.5800 - accuracy: 0.4587 - val_loss: 1.6395 - val_accuracy: 0.4366
Epoch 28/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5578 - accuracy: 0.4596 - val_loss: 1.6069 - val_accuracy: 0.4403
Epoch 29/100
34/34 [==============================] - 4s 126ms/step - loss: 1.4795 - accuracy: 0.4909 - val_loss: 1.6020 - val_accuracy: 0.4515
Epoch 30/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4857 - accuracy: 0.4946 - val_loss: 1.6100 - val_accuracy: 0.4291
Epoch 31/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4686 - accuracy: 0.4876 - val_loss: 1.6144 - val_accuracy: 0.4478
Epoch 32/100
34/34 [==============================] - 4s 126ms/step - loss: 1.4465 - accuracy: 0.5044 - val_loss: 1.6063 - val_accuracy: 0.4552
Epoch 00032: early stopping
Fold 5 - Test set accuracy: 39%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 160ms/step - loss: 3.2672 - accuracy: 0.0364 - val_loss: 3.2514 - val_accuracy: 0.0373
Epoch 2/100
34/34 [==============================] - 4s 125ms/step - loss: 3.2381 - accuracy: 0.0546 - val_loss: 3.1719 - val_accuracy: 0.0560
Epoch 3/100
34/34 [==============================] - 4s 125ms/step - loss: 3.1688 - accuracy: 0.0780 - val_loss: 3.0701 - val_accuracy: 0.0933
Epoch 4/100
34/34 [==============================] - 5s 133ms/step - loss: 3.0888 - accuracy: 0.0901 - val_loss: 2.9710 - val_accuracy: 0.1082
Epoch 5/100
34/34 [==============================] - 5s 138ms/step - loss: 3.0173 - accuracy: 0.0906 - val_loss: 2.8568 - val_accuracy: 0.1194
Epoch 6/100
34/34 [==============================] - 4s 130ms/step - loss: 2.9251 - accuracy: 0.1214 - val_loss: 2.8180 - val_accuracy: 0.1269
Epoch 7/100
34/34 [==============================] - 4s 130ms/step - loss: 2.8415 - accuracy: 0.1345 - val_loss: 2.7054 - val_accuracy: 0.1716
Epoch 8/100
34/34 [==============================] - 4s 128ms/step - loss: 2.7579 - accuracy: 0.1467 - val_loss: 2.6322 - val_accuracy: 0.1978
Epoch 9/100
34/34 [==============================] - 4s 127ms/step - loss: 2.6750 - accuracy: 0.1630 - val_loss: 2.5316 - val_accuracy: 0.2575
Epoch 10/100
34/34 [==============================] - 5s 134ms/step - loss: 2.5584 - accuracy: 0.1873 - val_loss: 2.4439 - val_accuracy: 0.2425
Epoch 11/100
34/34 [==============================] - 4s 129ms/step - loss: 2.4745 - accuracy: 0.2116 - val_loss: 2.3937 - val_accuracy: 0.2948
Epoch 12/100
34/34 [==============================] - 4s 125ms/step - loss: 2.4085 - accuracy: 0.2461 - val_loss: 2.3011 - val_accuracy: 0.2948
Epoch 13/100
34/34 [==============================] - 4s 125ms/step - loss: 2.3547 - accuracy: 0.2499 - val_loss: 2.2325 - val_accuracy: 0.3097
Epoch 14/100
34/34 [==============================] - 4s 125ms/step - loss: 2.2540 - accuracy: 0.2756 - val_loss: 2.1390 - val_accuracy: 0.3246
Epoch 15/100
34/34 [==============================] - 4s 125ms/step - loss: 2.1760 - accuracy: 0.2924 - val_loss: 2.0999 - val_accuracy: 0.3470
Epoch 16/100
34/34 [==============================] - 4s 124ms/step - loss: 2.0973 - accuracy: 0.3176 - val_loss: 2.0725 - val_accuracy: 0.3545
Epoch 17/100
34/34 [==============================] - 4s 125ms/step - loss: 2.0517 - accuracy: 0.3260 - val_loss: 1.9733 - val_accuracy: 0.3619
Epoch 18/100
34/34 [==============================] - 4s 130ms/step - loss: 2.0207 - accuracy: 0.3288 - val_loss: 1.9383 - val_accuracy: 0.3657
Epoch 19/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9707 - accuracy: 0.3419 - val_loss: 1.9221 - val_accuracy: 0.3731
Epoch 20/100
34/34 [==============================] - 4s 124ms/step - loss: 1.8885 - accuracy: 0.3695 - val_loss: 1.8890 - val_accuracy: 0.3694
Epoch 21/100
34/34 [==============================] - 4s 125ms/step - loss: 1.8416 - accuracy: 0.3830 - val_loss: 1.8371 - val_accuracy: 0.3993
Epoch 22/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7947 - accuracy: 0.3919 - val_loss: 1.8223 - val_accuracy: 0.3993
Epoch 23/100
34/34 [==============================] - 4s 125ms/step - loss: 1.7631 - accuracy: 0.3984 - val_loss: 1.7949 - val_accuracy: 0.3955
Epoch 24/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7420 - accuracy: 0.4171 - val_loss: 1.7796 - val_accuracy: 0.3806
Epoch 25/100
34/34 [==============================] - 4s 132ms/step - loss: 1.6992 - accuracy: 0.4222 - val_loss: 1.7558 - val_accuracy: 0.4216
Epoch 26/100
34/34 [==============================] - 4s 125ms/step - loss: 1.6725 - accuracy: 0.4306 - val_loss: 1.7290 - val_accuracy: 0.3843
Epoch 27/100
34/34 [==============================] - 5s 138ms/step - loss: 1.6057 - accuracy: 0.4362 - val_loss: 1.7186 - val_accuracy: 0.4104
Epoch 28/100
34/34 [==============================] - 5s 135ms/step - loss: 1.6203 - accuracy: 0.4428 - val_loss: 1.7001 - val_accuracy: 0.4216
Epoch 29/100
34/34 [==============================] - 5s 136ms/step - loss: 1.5819 - accuracy: 0.4512 - val_loss: 1.6539 - val_accuracy: 0.4366
Epoch 30/100
34/34 [==============================] - 5s 134ms/step - loss: 1.5266 - accuracy: 0.4713 - val_loss: 1.6312 - val_accuracy: 0.4179
Epoch 31/100
34/34 [==============================] - 4s 130ms/step - loss: 1.5084 - accuracy: 0.4657 - val_loss: 1.6788 - val_accuracy: 0.4104
Epoch 32/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4603 - accuracy: 0.4918 - val_loss: 1.6212 - val_accuracy: 0.4515
Epoch 33/100
34/34 [==============================] - 4s 126ms/step - loss: 1.4797 - accuracy: 0.4895 - val_loss: 1.6242 - val_accuracy: 0.4216
Epoch 34/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4100 - accuracy: 0.5026 - val_loss: 1.5913 - val_accuracy: 0.4664
Epoch 35/100
34/34 [==============================] - 4s 127ms/step - loss: 1.4094 - accuracy: 0.5147 - val_loss: 1.6621 - val_accuracy: 0.4403
Epoch 36/100
34/34 [==============================] - 4s 126ms/step - loss: 1.3758 - accuracy: 0.5194 - val_loss: 1.6314 - val_accuracy: 0.4403
Epoch 37/100
34/34 [==============================] - 4s 126ms/step - loss: 1.3784 - accuracy: 0.5142 - val_loss: 1.6309 - val_accuracy: 0.4403
Epoch 00037: early stopping
Fold 6 - Test set accuracy: 43%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 159ms/step - loss: 3.2650 - accuracy: 0.0373 - val_loss: 3.2462 - val_accuracy: 0.0524
Epoch 2/100
34/34 [==============================] - 4s 126ms/step - loss: 3.2206 - accuracy: 0.0625 - val_loss: 3.1509 - val_accuracy: 0.1049
Epoch 3/100
34/34 [==============================] - 4s 126ms/step - loss: 3.1378 - accuracy: 0.0681 - val_loss: 3.0487 - val_accuracy: 0.0974
Epoch 4/100
34/34 [==============================] - 4s 126ms/step - loss: 3.0414 - accuracy: 0.0807 - val_loss: 2.9849 - val_accuracy: 0.1124
Epoch 5/100
34/34 [==============================] - 4s 125ms/step - loss: 2.9551 - accuracy: 0.1003 - val_loss: 2.8266 - val_accuracy: 0.1386
Epoch 6/100
34/34 [==============================] - 4s 126ms/step - loss: 2.8777 - accuracy: 0.1209 - val_loss: 2.7420 - val_accuracy: 0.1311
Epoch 7/100
34/34 [==============================] - 4s 127ms/step - loss: 2.7832 - accuracy: 0.1437 - val_loss: 2.6606 - val_accuracy: 0.1798
Epoch 8/100
34/34 [==============================] - 4s 126ms/step - loss: 2.7108 - accuracy: 0.1540 - val_loss: 2.5505 - val_accuracy: 0.2434
Epoch 9/100
34/34 [==============================] - 4s 120ms/step - loss: 2.6186 - accuracy: 0.1839 - val_loss: 2.4615 - val_accuracy: 0.2772
Epoch 10/100
34/34 [==============================] - 4s 127ms/step - loss: 2.5082 - accuracy: 0.2151 - val_loss: 2.3165 - val_accuracy: 0.2996
Epoch 11/100
34/34 [==============================] - 4s 126ms/step - loss: 2.4749 - accuracy: 0.2198 - val_loss: 2.3135 - val_accuracy: 0.2584
Epoch 12/100
34/34 [==============================] - 4s 125ms/step - loss: 2.4096 - accuracy: 0.2389 - val_loss: 2.2483 - val_accuracy: 0.2884
Epoch 13/100
34/34 [==============================] - 4s 125ms/step - loss: 2.2550 - accuracy: 0.2678 - val_loss: 2.1701 - val_accuracy: 0.3034
Epoch 14/100
34/34 [==============================] - 4s 127ms/step - loss: 2.1982 - accuracy: 0.2996 - val_loss: 2.0726 - val_accuracy: 0.3034
Epoch 15/100
34/34 [==============================] - 4s 126ms/step - loss: 2.1457 - accuracy: 0.3150 - val_loss: 2.0555 - val_accuracy: 0.3408
Epoch 16/100
34/34 [==============================] - 5s 143ms/step - loss: 2.0736 - accuracy: 0.3271 - val_loss: 1.9778 - val_accuracy: 0.3670
Epoch 17/100
34/34 [==============================] - 4s 126ms/step - loss: 2.0063 - accuracy: 0.3364 - val_loss: 1.9419 - val_accuracy: 0.3670
Epoch 18/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9806 - accuracy: 0.3439 - val_loss: 1.8687 - val_accuracy: 0.4157
Epoch 19/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9385 - accuracy: 0.3668 - val_loss: 1.8607 - val_accuracy: 0.3858
Epoch 20/100
34/34 [==============================] - 4s 124ms/step - loss: 1.8757 - accuracy: 0.3682 - val_loss: 1.8278 - val_accuracy: 0.3895
Epoch 21/100
34/34 [==============================] - 4s 122ms/step - loss: 1.8320 - accuracy: 0.3724 - val_loss: 1.8058 - val_accuracy: 0.3933
Epoch 22/100
34/34 [==============================] - 4s 127ms/step - loss: 1.7679 - accuracy: 0.3934 - val_loss: 1.7815 - val_accuracy: 0.3820
Epoch 23/100
34/34 [==============================] - 5s 133ms/step - loss: 1.7622 - accuracy: 0.4036 - val_loss: 1.7678 - val_accuracy: 0.4082
Epoch 24/100
34/34 [==============================] - 4s 130ms/step - loss: 1.7117 - accuracy: 0.4139 - val_loss: 1.7756 - val_accuracy: 0.3783
Epoch 25/100
34/34 [==============================] - 4s 127ms/step - loss: 1.6940 - accuracy: 0.4256 - val_loss: 1.7379 - val_accuracy: 0.4007
Epoch 26/100
34/34 [==============================] - 5s 133ms/step - loss: 1.6417 - accuracy: 0.4414 - val_loss: 1.7140 - val_accuracy: 0.4270
Epoch 27/100
34/34 [==============================] - 4s 130ms/step - loss: 1.6079 - accuracy: 0.4648 - val_loss: 1.6731 - val_accuracy: 0.4120
Epoch 28/100
34/34 [==============================] - 5s 134ms/step - loss: 1.5619 - accuracy: 0.4578 - val_loss: 1.6427 - val_accuracy: 0.4232
Epoch 29/100
34/34 [==============================] - 4s 127ms/step - loss: 1.5551 - accuracy: 0.4536 - val_loss: 1.6682 - val_accuracy: 0.4195
Epoch 30/100
34/34 [==============================] - 4s 125ms/step - loss: 1.5046 - accuracy: 0.4568 - val_loss: 1.6446 - val_accuracy: 0.4232
Epoch 31/100
34/34 [==============================] - 4s 125ms/step - loss: 1.4852 - accuracy: 0.4783 - val_loss: 1.6480 - val_accuracy: 0.4082
Epoch 00031: early stopping
Fold 7 - Test set accuracy: 44%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 144ms/step - loss: 3.2609 - accuracy: 0.0420 - val_loss: 3.2266 - val_accuracy: 0.0448
Epoch 2/100
34/34 [==============================] - 4s 114ms/step - loss: 3.2037 - accuracy: 0.0617 - val_loss: 3.1099 - val_accuracy: 0.0821
Epoch 3/100
34/34 [==============================] - 4s 126ms/step - loss: 3.1275 - accuracy: 0.0827 - val_loss: 2.9962 - val_accuracy: 0.1045
Epoch 4/100
34/34 [==============================] - 4s 127ms/step - loss: 3.0397 - accuracy: 0.0972 - val_loss: 2.9439 - val_accuracy: 0.0970
Epoch 5/100
34/34 [==============================] - 4s 123ms/step - loss: 2.9565 - accuracy: 0.1004 - val_loss: 2.8261 - val_accuracy: 0.1306
Epoch 6/100
34/34 [==============================] - 4s 127ms/step - loss: 2.8423 - accuracy: 0.1275 - val_loss: 2.7197 - val_accuracy: 0.1604
Epoch 7/100
34/34 [==============================] - 5s 134ms/step - loss: 2.7726 - accuracy: 0.1509 - val_loss: 2.6977 - val_accuracy: 0.1754
Epoch 8/100
34/34 [==============================] - 5s 134ms/step - loss: 2.6537 - accuracy: 0.1756 - val_loss: 2.5404 - val_accuracy: 0.2015
Epoch 9/100
34/34 [==============================] - 5s 133ms/step - loss: 2.5679 - accuracy: 0.2064 - val_loss: 2.4720 - val_accuracy: 0.2090
Epoch 10/100
34/34 [==============================] - 4s 122ms/step - loss: 2.5162 - accuracy: 0.2172 - val_loss: 2.4371 - val_accuracy: 0.2537
Epoch 11/100
34/34 [==============================] - 4s 123ms/step - loss: 2.3877 - accuracy: 0.2504 - val_loss: 2.2668 - val_accuracy: 0.2985
Epoch 12/100
34/34 [==============================] - 4s 129ms/step - loss: 2.3053 - accuracy: 0.2644 - val_loss: 2.2533 - val_accuracy: 0.3060
Epoch 13/100
34/34 [==============================] - 4s 124ms/step - loss: 2.2416 - accuracy: 0.2606 - val_loss: 2.1617 - val_accuracy: 0.3172
Epoch 14/100
34/34 [==============================] - 4s 124ms/step - loss: 2.1751 - accuracy: 0.2896 - val_loss: 2.1574 - val_accuracy: 0.2910
Epoch 15/100
34/34 [==============================] - 4s 123ms/step - loss: 2.1076 - accuracy: 0.3101 - val_loss: 2.0862 - val_accuracy: 0.3321
Epoch 16/100
34/34 [==============================] - 4s 123ms/step - loss: 2.0234 - accuracy: 0.3382 - val_loss: 2.0035 - val_accuracy: 0.3321
Epoch 17/100
34/34 [==============================] - 4s 128ms/step - loss: 2.0058 - accuracy: 0.3461 - val_loss: 1.9560 - val_accuracy: 0.3731
Epoch 18/100
34/34 [==============================] - 4s 127ms/step - loss: 1.9474 - accuracy: 0.3718 - val_loss: 1.9169 - val_accuracy: 0.3843
Epoch 19/100
34/34 [==============================] - 4s 113ms/step - loss: 1.8822 - accuracy: 0.3718 - val_loss: 1.8764 - val_accuracy: 0.3806
Epoch 20/100
34/34 [==============================] - 4s 126ms/step - loss: 1.8369 - accuracy: 0.3797 - val_loss: 1.8610 - val_accuracy: 0.3843
Epoch 21/100
34/34 [==============================] - 4s 129ms/step - loss: 1.7644 - accuracy: 0.4120 - val_loss: 1.7916 - val_accuracy: 0.3955
Epoch 22/100
34/34 [==============================] - 4s 124ms/step - loss: 1.7163 - accuracy: 0.4246 - val_loss: 1.8062 - val_accuracy: 0.4067
Epoch 23/100
34/34 [==============================] - 4s 128ms/step - loss: 1.7014 - accuracy: 0.4264 - val_loss: 1.7566 - val_accuracy: 0.4142
Epoch 24/100
34/34 [==============================] - 4s 123ms/step - loss: 1.6756 - accuracy: 0.4404 - val_loss: 1.7116 - val_accuracy: 0.4328
Epoch 25/100
34/34 [==============================] - 4s 128ms/step - loss: 1.6288 - accuracy: 0.4376 - val_loss: 1.7471 - val_accuracy: 0.4067
Epoch 26/100
34/34 [==============================] - 5s 136ms/step - loss: 1.5721 - accuracy: 0.4563 - val_loss: 1.6785 - val_accuracy: 0.4366
Epoch 27/100
34/34 [==============================] - 4s 130ms/step - loss: 1.5051 - accuracy: 0.4787 - val_loss: 1.6946 - val_accuracy: 0.4478
Epoch 28/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5261 - accuracy: 0.4689 - val_loss: 1.6948 - val_accuracy: 0.4478
Epoch 29/100
34/34 [==============================] - 4s 127ms/step - loss: 1.5353 - accuracy: 0.4717 - val_loss: 1.6964 - val_accuracy: 0.4552
Epoch 00029: early stopping
Fold 8 - Test set accuracy: 45%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 150ms/step - loss: 3.2689 - accuracy: 0.0369 - val_loss: 3.2577 - val_accuracy: 0.0336
Epoch 2/100
34/34 [==============================] - 4s 115ms/step - loss: 3.2461 - accuracy: 0.0500 - val_loss: 3.2259 - val_accuracy: 0.0522
Epoch 3/100
34/34 [==============================] - 4s 114ms/step - loss: 3.2008 - accuracy: 0.0635 - val_loss: 3.1230 - val_accuracy: 0.0896
Epoch 4/100
34/34 [==============================] - 4s 116ms/step - loss: 3.1061 - accuracy: 0.0892 - val_loss: 2.9919 - val_accuracy: 0.1157
Epoch 5/100
34/34 [==============================] - 4s 124ms/step - loss: 3.0177 - accuracy: 0.0897 - val_loss: 2.8838 - val_accuracy: 0.1306
Epoch 6/100
34/34 [==============================] - 4s 124ms/step - loss: 2.9043 - accuracy: 0.1168 - val_loss: 2.8322 - val_accuracy: 0.1343
Epoch 7/100
34/34 [==============================] - 4s 127ms/step - loss: 2.8170 - accuracy: 0.1369 - val_loss: 2.7128 - val_accuracy: 0.1940
Epoch 8/100
34/34 [==============================] - 4s 118ms/step - loss: 2.6915 - accuracy: 0.1831 - val_loss: 2.6737 - val_accuracy: 0.1828
Epoch 9/100
34/34 [==============================] - 4s 114ms/step - loss: 2.6176 - accuracy: 0.1878 - val_loss: 2.5085 - val_accuracy: 0.2649
Epoch 10/100
34/34 [==============================] - 4s 116ms/step - loss: 2.4814 - accuracy: 0.2335 - val_loss: 2.3691 - val_accuracy: 0.2836
Epoch 11/100
34/34 [==============================] - 4s 128ms/step - loss: 2.3763 - accuracy: 0.2518 - val_loss: 2.3323 - val_accuracy: 0.2612
Epoch 12/100
34/34 [==============================] - 4s 126ms/step - loss: 2.2681 - accuracy: 0.2672 - val_loss: 2.1891 - val_accuracy: 0.3060
Epoch 13/100
34/34 [==============================] - 4s 125ms/step - loss: 2.1904 - accuracy: 0.2905 - val_loss: 2.1469 - val_accuracy: 0.3209
Epoch 14/100
34/34 [==============================] - 4s 122ms/step - loss: 2.1282 - accuracy: 0.3106 - val_loss: 2.1206 - val_accuracy: 0.3134
Epoch 15/100
34/34 [==============================] - 4s 129ms/step - loss: 2.0566 - accuracy: 0.3386 - val_loss: 2.0676 - val_accuracy: 0.3582
Epoch 16/100
34/34 [==============================] - 4s 126ms/step - loss: 1.9980 - accuracy: 0.3568 - val_loss: 1.9513 - val_accuracy: 0.3582
Epoch 17/100
34/34 [==============================] - 4s 125ms/step - loss: 1.8888 - accuracy: 0.3545 - val_loss: 1.9057 - val_accuracy: 0.3694
Epoch 18/100
34/34 [==============================] - 4s 125ms/step - loss: 1.8827 - accuracy: 0.3769 - val_loss: 1.9156 - val_accuracy: 0.3769
Epoch 19/100
34/34 [==============================] - 4s 125ms/step - loss: 1.7949 - accuracy: 0.3928 - val_loss: 1.8852 - val_accuracy: 0.3657
Epoch 20/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7781 - accuracy: 0.4092 - val_loss: 1.8273 - val_accuracy: 0.3694
Epoch 21/100
34/34 [==============================] - 4s 130ms/step - loss: 1.7144 - accuracy: 0.4232 - val_loss: 1.8104 - val_accuracy: 0.3918
Epoch 22/100
34/34 [==============================] - 4s 126ms/step - loss: 1.6692 - accuracy: 0.4325 - val_loss: 1.8384 - val_accuracy: 0.3806
Epoch 23/100
34/34 [==============================] - 4s 125ms/step - loss: 1.6120 - accuracy: 0.4568 - val_loss: 1.7642 - val_accuracy: 0.4104
Epoch 24/100
34/34 [==============================] - 4s 125ms/step - loss: 1.6421 - accuracy: 0.4493 - val_loss: 1.7497 - val_accuracy: 0.4067
Epoch 25/100
34/34 [==============================] - 4s 126ms/step - loss: 1.5820 - accuracy: 0.4479 - val_loss: 1.7183 - val_accuracy: 0.4142
Epoch 26/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5484 - accuracy: 0.4745 - val_loss: 1.7261 - val_accuracy: 0.4403
Epoch 27/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5087 - accuracy: 0.4830 - val_loss: 1.7083 - val_accuracy: 0.4440
Epoch 28/100
34/34 [==============================] - 4s 126ms/step - loss: 1.4911 - accuracy: 0.4773 - val_loss: 1.6851 - val_accuracy: 0.4216
Epoch 29/100
34/34 [==============================] - 4s 125ms/step - loss: 1.4949 - accuracy: 0.4937 - val_loss: 1.6921 - val_accuracy: 0.4552
Epoch 30/100
34/34 [==============================] - 4s 126ms/step - loss: 1.4303 - accuracy: 0.4932 - val_loss: 1.7076 - val_accuracy: 0.4328
Epoch 31/100
34/34 [==============================] - 4s 126ms/step - loss: 1.4288 - accuracy: 0.5068 - val_loss: 1.6712 - val_accuracy: 0.4291
Epoch 32/100
34/34 [==============================] - 4s 131ms/step - loss: 1.3799 - accuracy: 0.5245 - val_loss: 1.6375 - val_accuracy: 0.4403
Epoch 33/100
34/34 [==============================] - 4s 129ms/step - loss: 1.3717 - accuracy: 0.5334 - val_loss: 1.6472 - val_accuracy: 0.4590
Epoch 34/100
34/34 [==============================] - 4s 128ms/step - loss: 1.3667 - accuracy: 0.5423 - val_loss: 1.6273 - val_accuracy: 0.4627
Epoch 35/100
34/34 [==============================] - 4s 125ms/step - loss: 1.3414 - accuracy: 0.5488 - val_loss: 1.6324 - val_accuracy: 0.4590
Epoch 36/100
34/34 [==============================] - 4s 125ms/step - loss: 1.3298 - accuracy: 0.5367 - val_loss: 1.6070 - val_accuracy: 0.4403
Epoch 37/100
34/34 [==============================] - 4s 131ms/step - loss: 1.3138 - accuracy: 0.5455 - val_loss: 1.6675 - val_accuracy: 0.4291
Epoch 38/100
34/34 [==============================] - 4s 131ms/step - loss: 1.2989 - accuracy: 0.5390 - val_loss: 1.6554 - val_accuracy: 0.4142
Epoch 39/100
34/34 [==============================] - 4s 132ms/step - loss: 1.2358 - accuracy: 0.5838 - val_loss: 1.6414 - val_accuracy: 0.4291
Epoch 00039: early stopping
Fold 9 - Test set accuracy: 47%
Pipeline Completed
Epoch 1/100
34/34 [==============================] - 5s 158ms/step - loss: 3.2665 - accuracy: 0.0383 - val_loss: 3.2489 - val_accuracy: 0.0562
Epoch 2/100
34/34 [==============================] - 4s 129ms/step - loss: 3.2255 - accuracy: 0.0588 - val_loss: 3.1547 - val_accuracy: 0.0599
Epoch 3/100
34/34 [==============================] - 4s 126ms/step - loss: 3.1353 - accuracy: 0.0779 - val_loss: 3.0591 - val_accuracy: 0.0936
Epoch 4/100
34/34 [==============================] - 4s 120ms/step - loss: 3.0529 - accuracy: 0.0915 - val_loss: 2.9219 - val_accuracy: 0.1273
Epoch 5/100
34/34 [==============================] - 4s 126ms/step - loss: 2.9584 - accuracy: 0.1050 - val_loss: 2.8460 - val_accuracy: 0.1723
Epoch 6/100
34/34 [==============================] - 4s 131ms/step - loss: 2.8669 - accuracy: 0.1428 - val_loss: 2.7162 - val_accuracy: 0.1685
Epoch 7/100
34/34 [==============================] - 4s 129ms/step - loss: 2.7653 - accuracy: 0.1442 - val_loss: 2.6266 - val_accuracy: 0.2135
Epoch 8/100
34/34 [==============================] - 4s 129ms/step - loss: 2.6929 - accuracy: 0.1801 - val_loss: 2.5384 - val_accuracy: 0.2210
Epoch 9/100
34/34 [==============================] - 4s 125ms/step - loss: 2.5571 - accuracy: 0.2086 - val_loss: 2.4323 - val_accuracy: 0.2210
Epoch 10/100
34/34 [==============================] - 4s 125ms/step - loss: 2.4872 - accuracy: 0.2165 - val_loss: 2.3451 - val_accuracy: 0.2434
Epoch 11/100
34/34 [==============================] - 4s 124ms/step - loss: 2.3540 - accuracy: 0.2543 - val_loss: 2.2940 - val_accuracy: 0.2734
Epoch 12/100
34/34 [==============================] - 4s 125ms/step - loss: 2.2692 - accuracy: 0.2664 - val_loss: 2.2227 - val_accuracy: 0.2846
Epoch 13/100
34/34 [==============================] - 4s 127ms/step - loss: 2.2037 - accuracy: 0.2907 - val_loss: 2.1397 - val_accuracy: 0.2959
Epoch 14/100
34/34 [==============================] - 4s 131ms/step - loss: 2.1645 - accuracy: 0.3024 - val_loss: 2.1318 - val_accuracy: 0.3184
Epoch 15/100
34/34 [==============================] - 4s 127ms/step - loss: 2.1325 - accuracy: 0.3196 - val_loss: 2.0789 - val_accuracy: 0.3221
Epoch 16/100
34/34 [==============================] - 4s 124ms/step - loss: 2.0220 - accuracy: 0.3383 - val_loss: 2.0245 - val_accuracy: 0.3296
Epoch 17/100
34/34 [==============================] - 4s 125ms/step - loss: 2.0008 - accuracy: 0.3500 - val_loss: 1.9790 - val_accuracy: 0.3483
Epoch 18/100
34/34 [==============================] - 4s 125ms/step - loss: 1.9045 - accuracy: 0.3752 - val_loss: 1.9681 - val_accuracy: 0.3670
Epoch 19/100
34/34 [==============================] - 4s 125ms/step - loss: 1.8799 - accuracy: 0.3840 - val_loss: 1.8951 - val_accuracy: 0.3633
Epoch 20/100
34/34 [==============================] - 4s 131ms/step - loss: 1.8264 - accuracy: 0.3896 - val_loss: 1.8586 - val_accuracy: 0.3820
Epoch 21/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7842 - accuracy: 0.3980 - val_loss: 1.8148 - val_accuracy: 0.3670
Epoch 22/100
34/34 [==============================] - 4s 126ms/step - loss: 1.7525 - accuracy: 0.4036 - val_loss: 1.8494 - val_accuracy: 0.3596
Epoch 23/100
34/34 [==============================] - 4s 132ms/step - loss: 1.7135 - accuracy: 0.4288 - val_loss: 1.7969 - val_accuracy: 0.3970
Epoch 24/100
34/34 [==============================] - 4s 131ms/step - loss: 1.6972 - accuracy: 0.4279 - val_loss: 1.7607 - val_accuracy: 0.3933
Epoch 25/100
34/34 [==============================] - 5s 134ms/step - loss: 1.6148 - accuracy: 0.4545 - val_loss: 1.6973 - val_accuracy: 0.4382
Epoch 26/100
34/34 [==============================] - 4s 129ms/step - loss: 1.6226 - accuracy: 0.4680 - val_loss: 1.7577 - val_accuracy: 0.3895
Epoch 27/100
34/34 [==============================] - 4s 127ms/step - loss: 1.5894 - accuracy: 0.4671 - val_loss: 1.7238 - val_accuracy: 0.4419
Epoch 28/100
34/34 [==============================] - 4s 128ms/step - loss: 1.5590 - accuracy: 0.4685 - val_loss: 1.7438 - val_accuracy: 0.4232
Epoch 00028: early stopping
Fold 10 - Test set accuracy: 41%
[0.48, 0.43, 0.4, 0.43, 0.39, 0.43, 0.44, 0.45, 0.47, 0.41]
mean score: 0.43
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Done
[0.48, 0.43, 0.4, 0.43, 0.39, 0.43, 0.44, 0.45, 0.47, 0.41]
mean score: 0.43
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

