---

title: 10-fold Cross Validation


keywords: fastai
sidebar: home_sidebar

summary: "Code for training is the same as Notebook 05."
description: "Code for training is the same as Notebook 05."
nb_path: "08_Ten-fold_Cross_Validation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 08_Ten-fold_Cross_Validation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">car_speech.fname_processing</span> <span class="kn">import</span> <span class="n">load_fnames</span>
<span class="kn">from</span> <span class="nn">car_speech.pipeline</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers.experimental</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">KFold</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Configuration">Configuration<a class="anchor-link" href="#Configuration"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATASET_TYPE</span> <span class="o">=</span> <span class="s1">&#39;mixed&#39;</span> <span class="c1"># &#39;digits&#39; or &#39;letters&#39; or &#39;mixed&#39;</span>

<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># load classified filenames</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">load_fnames</span><span class="p">(</span><span class="s1">&#39;noise_levels/mixed_noise_levels/IDL.data&#39;</span><span class="p">)</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of files:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">))</span>

<span class="c1"># shuffle</span>
<span class="n">shuffle</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>

<span class="n">fold_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">acc_per_fold</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of files: 4274
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;digits&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)])</span>
<span class="k">elif</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;letters&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>
<span class="k">elif</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;mixed&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loop-for-10-fold">Loop for 10-fold<a class="anchor-link" href="#Loop-for-10-fold"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beg_ratio</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">beg_ratio</span> <span class="o">&lt;</span> <span class="mf">0.9</span><span class="p">:</span>
    <span class="n">test_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">beg_ratio</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="n">test_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">beg_ratio</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    
    <span class="n">fnames_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    
    <span class="n">val_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">fnames_copy</span>
    
    <span class="n">beg_ratio</span> <span class="o">+=</span> <span class="mf">0.1</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">train_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">val_files</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    

    <span class="c1"># Process data using the combined pipeline</span>
    <span class="n">spectrogram_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">train_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">spectrogram_ds</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">val_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">test_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">test_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pipeline Completed&quot;</span><span class="p">)</span>
    
    <span class="c1"># batch</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    
    <span class="n">AUTOTUNE</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    
    <span class="c1"># model</span>
    <span class="k">for</span> <span class="n">spectrogram</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">spectrogram</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">#     print(&#39;Input shape:&#39;, input_shape)</span>
    <span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_strings</span><span class="p">)</span>

    <span class="n">norm_layer</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">Normalization</span><span class="p">()</span>
    <span class="n">norm_layer</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">x</span><span class="p">))</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">),</span>
        <span class="n">preprocessing</span><span class="o">.</span><span class="n">Resizing</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> 
        <span class="n">norm_layer</span><span class="p">,</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_labels</span><span class="p">),</span>
    <span class="p">])</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span>
    <span class="p">)</span>
    
    <span class="c1"># Train</span>
    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_ds</span><span class="p">,</span> 
        <span class="n">validation_data</span><span class="o">=</span><span class="n">val_ds</span><span class="p">,</span>  
        <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">test_audio</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">audio</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">test_ds</span><span class="p">:</span>
        <span class="n">test_audio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        <span class="n">test_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

    <span class="n">test_audio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_audio</span><span class="p">)</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_audio</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">test_labels</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fold </span><span class="si">{</span><span class="n">fold_no</span><span class="si">}</span><span class="s1"> - Test set accuracy: </span><span class="si">{</span><span class="n">test_acc</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">acc_per_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">test_acc</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">fold_no</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline Completed
Epoch 1/30
54/54 [==============================] - 20s 365ms/step - loss: 3.4347 - accuracy: 0.0898 - val_loss: 3.1279 - val_accuracy: 0.1710
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 3.0309 - accuracy: 0.1789 - val_loss: 2.6762 - val_accuracy: 0.2810
Epoch 3/30
54/54 [==============================] - 4s 70ms/step - loss: 2.6449 - accuracy: 0.2468 - val_loss: 2.3646 - val_accuracy: 0.3208
Epoch 4/30
54/54 [==============================] - 4s 71ms/step - loss: 2.3671 - accuracy: 0.2982 - val_loss: 2.1578 - val_accuracy: 0.4052
Epoch 5/30
54/54 [==============================] - 4s 73ms/step - loss: 2.1275 - accuracy: 0.3632 - val_loss: 2.0480 - val_accuracy: 0.4122
Epoch 6/30
54/54 [==============================] - 4s 73ms/step - loss: 1.9519 - accuracy: 0.3956 - val_loss: 1.9444 - val_accuracy: 0.4309
Epoch 7/30
54/54 [==============================] - 4s 69ms/step - loss: 1.8109 - accuracy: 0.4421 - val_loss: 1.8731 - val_accuracy: 0.4496
Epoch 8/30
54/54 [==============================] - 4s 70ms/step - loss: 1.6624 - accuracy: 0.4848 - val_loss: 1.8503 - val_accuracy: 0.4660
Epoch 9/30
54/54 [==============================] - 4s 72ms/step - loss: 1.5463 - accuracy: 0.5146 - val_loss: 1.7752 - val_accuracy: 0.4684
Epoch 10/30
54/54 [==============================] - 4s 70ms/step - loss: 1.4631 - accuracy: 0.5365 - val_loss: 1.7573 - val_accuracy: 0.5105
Epoch 11/30
54/54 [==============================] - 4s 71ms/step - loss: 1.3696 - accuracy: 0.5713 - val_loss: 1.7465 - val_accuracy: 0.4988
Epoch 12/30
54/54 [==============================] - 4s 71ms/step - loss: 1.2857 - accuracy: 0.5860 - val_loss: 1.7348 - val_accuracy: 0.5199
Epoch 13/30
54/54 [==============================] - 4s 70ms/step - loss: 1.2076 - accuracy: 0.6193 - val_loss: 1.7129 - val_accuracy: 0.5035
Epoch 14/30
54/54 [==============================] - 4s 72ms/step - loss: 1.1401 - accuracy: 0.6307 - val_loss: 1.7146 - val_accuracy: 0.5199
Epoch 15/30
54/54 [==============================] - 4s 71ms/step - loss: 1.0630 - accuracy: 0.6561 - val_loss: 1.7954 - val_accuracy: 0.5386
Epoch 00015: early stopping
Fold 1 - Test set accuracy: 50%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 17s 307ms/step - loss: 3.3520 - accuracy: 0.1058 - val_loss: 2.9676 - val_accuracy: 0.2436
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 2.9016 - accuracy: 0.2085 - val_loss: 2.5999 - val_accuracy: 0.3115
Epoch 3/30
54/54 [==============================] - 4s 71ms/step - loss: 2.5679 - accuracy: 0.2781 - val_loss: 2.3036 - val_accuracy: 0.3560
Epoch 4/30
54/54 [==============================] - 4s 71ms/step - loss: 2.2806 - accuracy: 0.3319 - val_loss: 2.1343 - val_accuracy: 0.3958
Epoch 5/30
54/54 [==============================] - 4s 71ms/step - loss: 2.0588 - accuracy: 0.3833 - val_loss: 1.9731 - val_accuracy: 0.4356
Epoch 6/30
54/54 [==============================] - 4s 70ms/step - loss: 1.8765 - accuracy: 0.4251 - val_loss: 1.9229 - val_accuracy: 0.4379
Epoch 7/30
54/54 [==============================] - 4s 71ms/step - loss: 1.7028 - accuracy: 0.4722 - val_loss: 1.8361 - val_accuracy: 0.4543
Epoch 8/30
54/54 [==============================] - 4s 71ms/step - loss: 1.5918 - accuracy: 0.5067 - val_loss: 1.8081 - val_accuracy: 0.4637
Epoch 9/30
54/54 [==============================] - 4s 70ms/step - loss: 1.4465 - accuracy: 0.5488 - val_loss: 1.8008 - val_accuracy: 0.5012
Epoch 10/30
54/54 [==============================] - 4s 70ms/step - loss: 1.3339 - accuracy: 0.5789 - val_loss: 1.7827 - val_accuracy: 0.4895
Epoch 11/30
54/54 [==============================] - 4s 69ms/step - loss: 1.2552 - accuracy: 0.5994 - val_loss: 1.7855 - val_accuracy: 0.4871
Epoch 12/30
54/54 [==============================] - 4s 72ms/step - loss: 1.1549 - accuracy: 0.6330 - val_loss: 1.7804 - val_accuracy: 0.4988
Epoch 13/30
54/54 [==============================] - 4s 71ms/step - loss: 1.0990 - accuracy: 0.6462 - val_loss: 1.8344 - val_accuracy: 0.5035
Epoch 14/30
54/54 [==============================] - 4s 72ms/step - loss: 1.0415 - accuracy: 0.6652 - val_loss: 1.7752 - val_accuracy: 0.5082
Epoch 15/30
54/54 [==============================] - 4s 72ms/step - loss: 0.9888 - accuracy: 0.6836 - val_loss: 1.8089 - val_accuracy: 0.4965
Epoch 16/30
54/54 [==============================] - 4s 71ms/step - loss: 0.9125 - accuracy: 0.7064 - val_loss: 1.8477 - val_accuracy: 0.5316
Epoch 00016: early stopping
Fold 2 - Test set accuracy: 54%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 12s 231ms/step - loss: 3.4044 - accuracy: 0.0898 - val_loss: 3.0696 - val_accuracy: 0.1939
Epoch 2/30
54/54 [==============================] - 4s 70ms/step - loss: 2.9891 - accuracy: 0.1896 - val_loss: 2.6587 - val_accuracy: 0.2780
Epoch 3/30
54/54 [==============================] - 4s 72ms/step - loss: 2.6113 - accuracy: 0.2428 - val_loss: 2.3485 - val_accuracy: 0.3084
Epoch 4/30
54/54 [==============================] - 4s 72ms/step - loss: 2.3158 - accuracy: 0.3177 - val_loss: 2.1745 - val_accuracy: 0.3738
Epoch 5/30
54/54 [==============================] - 4s 72ms/step - loss: 2.1292 - accuracy: 0.3654 - val_loss: 2.0443 - val_accuracy: 0.4136
Epoch 6/30
54/54 [==============================] - 4s 72ms/step - loss: 1.9065 - accuracy: 0.4245 - val_loss: 1.9452 - val_accuracy: 0.4112
Epoch 7/30
54/54 [==============================] - 4s 71ms/step - loss: 1.7455 - accuracy: 0.4725 - val_loss: 1.8898 - val_accuracy: 0.4579
Epoch 8/30
54/54 [==============================] - 4s 72ms/step - loss: 1.6012 - accuracy: 0.5053 - val_loss: 1.8239 - val_accuracy: 0.4743
Epoch 9/30
54/54 [==============================] - 4s 71ms/step - loss: 1.4786 - accuracy: 0.5439 - val_loss: 1.8042 - val_accuracy: 0.4743
Epoch 10/30
54/54 [==============================] - 4s 72ms/step - loss: 1.3687 - accuracy: 0.5644 - val_loss: 1.8292 - val_accuracy: 0.4603
Epoch 11/30
54/54 [==============================] - 4s 72ms/step - loss: 1.2868 - accuracy: 0.5954 - val_loss: 1.8121 - val_accuracy: 0.5093
Epoch 00011: early stopping
Fold 3 - Test set accuracy: 50%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 13s 245ms/step - loss: 3.4166 - accuracy: 0.0965 - val_loss: 3.0269 - val_accuracy: 0.1944
Epoch 2/30
54/54 [==============================] - 4s 71ms/step - loss: 2.9158 - accuracy: 0.1810 - val_loss: 2.6155 - val_accuracy: 0.2998
Epoch 3/30
54/54 [==============================] - 4s 73ms/step - loss: 2.5902 - accuracy: 0.2567 - val_loss: 2.3643 - val_accuracy: 0.3326
Epoch 4/30
54/54 [==============================] - 4s 79ms/step - loss: 2.3692 - accuracy: 0.3041 - val_loss: 2.1967 - val_accuracy: 0.3630
Epoch 5/30
54/54 [==============================] - 4s 72ms/step - loss: 2.1518 - accuracy: 0.3570 - val_loss: 2.0325 - val_accuracy: 0.4052
Epoch 6/30
54/54 [==============================] - 4s 71ms/step - loss: 1.9571 - accuracy: 0.4082 - val_loss: 1.9477 - val_accuracy: 0.4333
Epoch 7/30
54/54 [==============================] - 4s 72ms/step - loss: 1.7823 - accuracy: 0.4515 - val_loss: 1.8494 - val_accuracy: 0.4473
Epoch 8/30
54/54 [==============================] - 4s 72ms/step - loss: 1.6262 - accuracy: 0.4880 - val_loss: 1.8015 - val_accuracy: 0.4731
Epoch 9/30
54/54 [==============================] - 4s 73ms/step - loss: 1.4981 - accuracy: 0.5278 - val_loss: 1.7941 - val_accuracy: 0.4988
Epoch 10/30
54/54 [==============================] - 4s 71ms/step - loss: 1.4130 - accuracy: 0.5570 - val_loss: 1.7910 - val_accuracy: 0.5035
Epoch 11/30
54/54 [==============================] - 4s 72ms/step - loss: 1.2786 - accuracy: 0.5980 - val_loss: 1.7556 - val_accuracy: 0.4918
Epoch 12/30
54/54 [==============================] - 4s 72ms/step - loss: 1.1912 - accuracy: 0.6202 - val_loss: 1.7575 - val_accuracy: 0.5012
Epoch 13/30
54/54 [==============================] - 4s 72ms/step - loss: 1.1794 - accuracy: 0.6327 - val_loss: 1.7581 - val_accuracy: 0.4918
Epoch 00013: early stopping
Fold 4 - Test set accuracy: 48%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 12s 214ms/step - loss: 3.4148 - accuracy: 0.0925 - val_loss: 3.0999 - val_accuracy: 0.2173
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 2.9425 - accuracy: 0.1928 - val_loss: 2.6534 - val_accuracy: 0.2757
Epoch 3/30
54/54 [==============================] - 4s 70ms/step - loss: 2.5885 - accuracy: 0.2528 - val_loss: 2.3027 - val_accuracy: 0.3598
Epoch 4/30
54/54 [==============================] - 4s 70ms/step - loss: 2.3238 - accuracy: 0.3148 - val_loss: 2.1172 - val_accuracy: 0.3855
Epoch 5/30
54/54 [==============================] - 4s 70ms/step - loss: 2.0910 - accuracy: 0.3704 - val_loss: 2.0085 - val_accuracy: 0.4416
Epoch 6/30
54/54 [==============================] - 4s 70ms/step - loss: 1.9005 - accuracy: 0.4204 - val_loss: 1.8514 - val_accuracy: 0.4556
Epoch 7/30
54/54 [==============================] - 4s 70ms/step - loss: 1.7601 - accuracy: 0.4547 - val_loss: 1.7646 - val_accuracy: 0.4743
Epoch 8/30
54/54 [==============================] - 4s 70ms/step - loss: 1.5910 - accuracy: 0.5135 - val_loss: 1.6983 - val_accuracy: 0.4907
Epoch 9/30
54/54 [==============================] - 4s 70ms/step - loss: 1.4741 - accuracy: 0.5451 - val_loss: 1.7116 - val_accuracy: 0.5023
Epoch 10/30
54/54 [==============================] - 4s 70ms/step - loss: 1.3792 - accuracy: 0.5676 - val_loss: 1.6283 - val_accuracy: 0.5187
Epoch 11/30
54/54 [==============================] - 4s 70ms/step - loss: 1.2908 - accuracy: 0.5983 - val_loss: 1.6027 - val_accuracy: 0.5257
Epoch 12/30
54/54 [==============================] - 4s 71ms/step - loss: 1.1766 - accuracy: 0.6273 - val_loss: 1.6313 - val_accuracy: 0.5164
Epoch 13/30
54/54 [==============================] - 4s 70ms/step - loss: 1.1206 - accuracy: 0.6322 - val_loss: 1.6392 - val_accuracy: 0.5210
Epoch 00013: early stopping
Fold 5 - Test set accuracy: 55%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 8s 156ms/step - loss: 3.4598 - accuracy: 0.0781 - val_loss: 3.1319 - val_accuracy: 0.1897
Epoch 2/30
54/54 [==============================] - 4s 70ms/step - loss: 2.9755 - accuracy: 0.1953 - val_loss: 2.6972 - val_accuracy: 0.2834
Epoch 3/30
54/54 [==============================] - 4s 72ms/step - loss: 2.6101 - accuracy: 0.2588 - val_loss: 2.4130 - val_accuracy: 0.3513
Epoch 4/30
54/54 [==============================] - 4s 72ms/step - loss: 2.3116 - accuracy: 0.3167 - val_loss: 2.2109 - val_accuracy: 0.3934
Epoch 5/30
54/54 [==============================] - 4s 72ms/step - loss: 2.0893 - accuracy: 0.3725 - val_loss: 2.0789 - val_accuracy: 0.4192
Epoch 6/30
54/54 [==============================] - 4s 73ms/step - loss: 1.8862 - accuracy: 0.4187 - val_loss: 1.9803 - val_accuracy: 0.4426
Epoch 7/30
54/54 [==============================] - 4s 69ms/step - loss: 1.7329 - accuracy: 0.4640 - val_loss: 1.9107 - val_accuracy: 0.4731
Epoch 8/30
54/54 [==============================] - 4s 68ms/step - loss: 1.5902 - accuracy: 0.5096 - val_loss: 1.8503 - val_accuracy: 0.4707
Epoch 9/30
54/54 [==============================] - 4s 70ms/step - loss: 1.4422 - accuracy: 0.5494 - val_loss: 1.8262 - val_accuracy: 0.4848
Epoch 10/30
54/54 [==============================] - 4s 70ms/step - loss: 1.3659 - accuracy: 0.5614 - val_loss: 1.7738 - val_accuracy: 0.5035
Epoch 11/30
54/54 [==============================] - 4s 71ms/step - loss: 1.2368 - accuracy: 0.6079 - val_loss: 1.7666 - val_accuracy: 0.5059
Epoch 12/30
54/54 [==============================] - 4s 70ms/step - loss: 1.1354 - accuracy: 0.6424 - val_loss: 1.7541 - val_accuracy: 0.5199
Epoch 13/30
54/54 [==============================] - 4s 68ms/step - loss: 1.0953 - accuracy: 0.6482 - val_loss: 1.7386 - val_accuracy: 0.5105
Epoch 14/30
54/54 [==============================] - 4s 70ms/step - loss: 1.0293 - accuracy: 0.6813 - val_loss: 1.7409 - val_accuracy: 0.5574
Epoch 15/30
54/54 [==============================] - 4s 72ms/step - loss: 0.9416 - accuracy: 0.6980 - val_loss: 1.8839 - val_accuracy: 0.5012
Epoch 00015: early stopping
Fold 6 - Test set accuracy: 48%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 6s 103ms/step - loss: 3.4164 - accuracy: 0.1023 - val_loss: 3.1089 - val_accuracy: 0.2201
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 2.9421 - accuracy: 0.1921 - val_loss: 2.6254 - val_accuracy: 0.3138
Epoch 3/30
54/54 [==============================] - 4s 71ms/step - loss: 2.5995 - accuracy: 0.2617 - val_loss: 2.3152 - val_accuracy: 0.3747
Epoch 4/30
54/54 [==============================] - 4s 71ms/step - loss: 2.3275 - accuracy: 0.3140 - val_loss: 2.1326 - val_accuracy: 0.3958
Epoch 5/30
54/54 [==============================] - 4s 71ms/step - loss: 2.1119 - accuracy: 0.3702 - val_loss: 2.0068 - val_accuracy: 0.4005
Epoch 6/30
54/54 [==============================] - 4s 71ms/step - loss: 1.8901 - accuracy: 0.4316 - val_loss: 1.8958 - val_accuracy: 0.4262
Epoch 7/30
54/54 [==============================] - 4s 71ms/step - loss: 1.7011 - accuracy: 0.4751 - val_loss: 1.8096 - val_accuracy: 0.4660
Epoch 8/30
54/54 [==============================] - 4s 70ms/step - loss: 1.6142 - accuracy: 0.4974 - val_loss: 1.7755 - val_accuracy: 0.4918
Epoch 9/30
54/54 [==============================] - 4s 71ms/step - loss: 1.4764 - accuracy: 0.5456 - val_loss: 1.7355 - val_accuracy: 0.4941
Epoch 10/30
54/54 [==============================] - 4s 70ms/step - loss: 1.3641 - accuracy: 0.5664 - val_loss: 1.7216 - val_accuracy: 0.4918
Epoch 11/30
54/54 [==============================] - 4s 70ms/step - loss: 1.2804 - accuracy: 0.5939 - val_loss: 1.6979 - val_accuracy: 0.5316
Epoch 12/30
54/54 [==============================] - 4s 70ms/step - loss: 1.1617 - accuracy: 0.6363 - val_loss: 1.6629 - val_accuracy: 0.5246
Epoch 13/30
54/54 [==============================] - 4s 71ms/step - loss: 1.1054 - accuracy: 0.6506 - val_loss: 1.6667 - val_accuracy: 0.5269
Epoch 14/30
54/54 [==============================] - 4s 70ms/step - loss: 1.0200 - accuracy: 0.6667 - val_loss: 1.7514 - val_accuracy: 0.5105
Epoch 00014: early stopping
Fold 7 - Test set accuracy: 52%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 6s 104ms/step - loss: 3.4163 - accuracy: 0.0936 - val_loss: 3.0747 - val_accuracy: 0.1986
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 2.9451 - accuracy: 0.1896 - val_loss: 2.6263 - val_accuracy: 0.2850
Epoch 3/30
54/54 [==============================] - 4s 68ms/step - loss: 2.5941 - accuracy: 0.2624 - val_loss: 2.4331 - val_accuracy: 0.3178
Epoch 4/30
54/54 [==============================] - 4s 71ms/step - loss: 2.3608 - accuracy: 0.3013 - val_loss: 2.1750 - val_accuracy: 0.3715
Epoch 5/30
54/54 [==============================] - 4s 71ms/step - loss: 2.1545 - accuracy: 0.3549 - val_loss: 2.0863 - val_accuracy: 0.3832
Epoch 6/30
54/54 [==============================] - 4s 70ms/step - loss: 1.9771 - accuracy: 0.3973 - val_loss: 1.9752 - val_accuracy: 0.4206
Epoch 7/30
54/54 [==============================] - 4s 71ms/step - loss: 1.8223 - accuracy: 0.4427 - val_loss: 1.8757 - val_accuracy: 0.4393
Epoch 8/30
54/54 [==============================] - 4s 71ms/step - loss: 1.6591 - accuracy: 0.4801 - val_loss: 1.8376 - val_accuracy: 0.4486
Epoch 9/30
54/54 [==============================] - 4s 72ms/step - loss: 1.5464 - accuracy: 0.5146 - val_loss: 1.8331 - val_accuracy: 0.4696
Epoch 10/30
54/54 [==============================] - 4s 71ms/step - loss: 1.4601 - accuracy: 0.5480 - val_loss: 1.7296 - val_accuracy: 0.4743
Epoch 11/30
54/54 [==============================] - 4s 71ms/step - loss: 1.3775 - accuracy: 0.5568 - val_loss: 1.7429 - val_accuracy: 0.4977
Epoch 12/30
54/54 [==============================] - 4s 71ms/step - loss: 1.2492 - accuracy: 0.6062 - val_loss: 1.7558 - val_accuracy: 0.5000
Epoch 00012: early stopping
Fold 8 - Test set accuracy: 55%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 7s 133ms/step - loss: 3.4627 - accuracy: 0.0947 - val_loss: 3.1757 - val_accuracy: 0.1897
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 2.9834 - accuracy: 0.1845 - val_loss: 2.6830 - val_accuracy: 0.2951
Epoch 3/30
54/54 [==============================] - 4s 70ms/step - loss: 2.6068 - accuracy: 0.2515 - val_loss: 2.3786 - val_accuracy: 0.3536
Epoch 4/30
54/54 [==============================] - 4s 70ms/step - loss: 2.3015 - accuracy: 0.3278 - val_loss: 2.1769 - val_accuracy: 0.3981
Epoch 5/30
54/54 [==============================] - 4s 70ms/step - loss: 2.0483 - accuracy: 0.3924 - val_loss: 2.0824 - val_accuracy: 0.4309
Epoch 6/30
54/54 [==============================] - 4s 70ms/step - loss: 1.8652 - accuracy: 0.4374 - val_loss: 2.0054 - val_accuracy: 0.4169
Epoch 7/30
54/54 [==============================] - 4s 70ms/step - loss: 1.7010 - accuracy: 0.4839 - val_loss: 1.9747 - val_accuracy: 0.4333
Epoch 8/30
54/54 [==============================] - 4s 70ms/step - loss: 1.5933 - accuracy: 0.5050 - val_loss: 1.8866 - val_accuracy: 0.4637
Epoch 9/30
54/54 [==============================] - 4s 70ms/step - loss: 1.4413 - accuracy: 0.5553 - val_loss: 1.9703 - val_accuracy: 0.4520
Epoch 10/30
54/54 [==============================] - 4s 69ms/step - loss: 1.3261 - accuracy: 0.5839 - val_loss: 1.9245 - val_accuracy: 0.4801
Epoch 00010: early stopping
Fold 9 - Test set accuracy: 45%
Pipeline Completed
Epoch 1/30
54/54 [==============================] - 5s 100ms/step - loss: 3.4498 - accuracy: 0.0927 - val_loss: 3.1269 - val_accuracy: 0.1452
Epoch 2/30
54/54 [==============================] - 4s 69ms/step - loss: 2.9832 - accuracy: 0.1871 - val_loss: 2.7112 - val_accuracy: 0.2553
Epoch 3/30
54/54 [==============================] - 4s 70ms/step - loss: 2.6856 - accuracy: 0.2333 - val_loss: 2.4629 - val_accuracy: 0.2998
Epoch 4/30
54/54 [==============================] - 4s 68ms/step - loss: 2.3864 - accuracy: 0.3015 - val_loss: 2.2461 - val_accuracy: 0.3513
Epoch 5/30
54/54 [==============================] - 4s 70ms/step - loss: 2.1375 - accuracy: 0.3579 - val_loss: 2.0890 - val_accuracy: 0.3888
Epoch 6/30
54/54 [==============================] - 4s 70ms/step - loss: 1.9515 - accuracy: 0.4167 - val_loss: 2.0150 - val_accuracy: 0.3911
Epoch 7/30
54/54 [==============================] - 4s 71ms/step - loss: 1.7785 - accuracy: 0.4570 - val_loss: 1.9488 - val_accuracy: 0.3958
Epoch 8/30
54/54 [==============================] - 4s 70ms/step - loss: 1.6337 - accuracy: 0.5032 - val_loss: 1.8927 - val_accuracy: 0.4426
Epoch 9/30
54/54 [==============================] - 4s 68ms/step - loss: 1.5166 - accuracy: 0.5287 - val_loss: 1.8831 - val_accuracy: 0.4473
Epoch 10/30
54/54 [==============================] - 4s 68ms/step - loss: 1.4275 - accuracy: 0.5547 - val_loss: 1.7948 - val_accuracy: 0.4731
Epoch 11/30
54/54 [==============================] - 4s 68ms/step - loss: 1.3509 - accuracy: 0.5649 - val_loss: 1.7916 - val_accuracy: 0.4801
Epoch 12/30
54/54 [==============================] - 4s 70ms/step - loss: 1.2516 - accuracy: 0.6111 - val_loss: 1.8871 - val_accuracy: 0.4543
Epoch 13/30
54/54 [==============================] - 4s 70ms/step - loss: 1.1700 - accuracy: 0.6342 - val_loss: 1.8722 - val_accuracy: 0.4801
Epoch 00013: early stopping
Fold 10 - Test set accuracy: 47%
[0.5, 0.54, 0.5, 0.48, 0.55, 0.48, 0.52, 0.55, 0.45, 0.47]
mean score: 0.5
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Done
[0.5, 0.54, 0.5, 0.48, 0.55, 0.48, 0.52, 0.55, 0.45, 0.47]
mean score: 0.5
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

