---

title: 10-fold Cross Validation


keywords: fastai
sidebar: home_sidebar

summary: "Code for training is the same as Notebook 05."
description: "Code for training is the same as Notebook 05."
nb_path: "06_Ten-fold_Cross_Validation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 06_Ten-fold_Cross_Validation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">car_speech.fname_processing</span> <span class="kn">import</span> <span class="n">load_fnames</span>
<span class="kn">from</span> <span class="nn">car_speech.pipeline</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers.experimental</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">KFold</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Configuration">Configuration<a class="anchor-link" href="#Configuration"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATASET_TYPE</span> <span class="o">=</span> <span class="s1">&#39;digits&#39;</span> <span class="c1"># or &#39;letters&#39;</span>
<span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># load classified filenames</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">load_fnames</span><span class="p">(</span><span class="s1">&#39;noise_levels/digit_noise_levels/35U.data&#39;</span><span class="p">)</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of files:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">))</span>

<span class="c1"># shuffle</span>
<span class="n">shuffle</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>

<span class="n">fold_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">acc_per_fold</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of files: 1590
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loop-for-10-fold">Loop for 10-fold<a class="anchor-link" href="#Loop-for-10-fold"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beg_ratio</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">beg_ratio</span> <span class="o">&lt;</span> <span class="mf">0.9</span><span class="p">:</span>
    <span class="n">test_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">beg_ratio</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="n">test_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">beg_ratio</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    
    <span class="n">fnames_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    
    <span class="n">val_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">fnames_copy</span>
    
    <span class="n">beg_ratio</span> <span class="o">+=</span> <span class="mf">0.1</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">train_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">val_files</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    

    <span class="c1"># Process data using the combined pipeline</span>
    <span class="n">spectrogram_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">train_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">spectrogram_ds</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">val_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">test_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">test_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pipeline Completed&quot;</span><span class="p">)</span>
    
    <span class="c1"># batch</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    
    <span class="n">AUTOTUNE</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    
    <span class="c1"># model</span>
    <span class="k">for</span> <span class="n">spectrogram</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">spectrogram</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">#     print(&#39;Input shape:&#39;, input_shape)</span>
    <span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_strings</span><span class="p">)</span>

    <span class="n">norm_layer</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">Normalization</span><span class="p">()</span>
    <span class="n">norm_layer</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">x</span><span class="p">))</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">),</span>
        <span class="n">preprocessing</span><span class="o">.</span><span class="n">Resizing</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> 
        <span class="n">norm_layer</span><span class="p">,</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_labels</span><span class="p">),</span>
    <span class="p">])</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span>
    <span class="p">)</span>
    
    <span class="c1"># Train</span>
    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_ds</span><span class="p">,</span> 
        <span class="n">validation_data</span><span class="o">=</span><span class="n">val_ds</span><span class="p">,</span>  
        <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">test_audio</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">audio</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">test_ds</span><span class="p">:</span>
        <span class="n">test_audio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        <span class="n">test_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

    <span class="n">test_audio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_audio</span><span class="p">)</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_audio</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">test_labels</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fold </span><span class="si">{</span><span class="n">fold_no</span><span class="si">}</span><span class="s1"> - Test set accuracy: </span><span class="si">{</span><span class="n">test_acc</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">acc_per_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">test_acc</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">fold_no</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 112ms/step - loss: 2.1765 - accuracy: 0.2115 - val_loss: 1.9110 - val_accuracy: 0.3585
Epoch 2/30
20/20 [==============================] - 1s 69ms/step - loss: 1.6624 - accuracy: 0.4253 - val_loss: 1.4312 - val_accuracy: 0.5094
Epoch 3/30
20/20 [==============================] - 1s 69ms/step - loss: 1.3643 - accuracy: 0.5275 - val_loss: 1.2580 - val_accuracy: 0.5157
Epoch 4/30
20/20 [==============================] - 1s 71ms/step - loss: 1.2516 - accuracy: 0.5684 - val_loss: 1.1717 - val_accuracy: 0.5472
Epoch 5/30
20/20 [==============================] - 1s 70ms/step - loss: 1.0913 - accuracy: 0.6242 - val_loss: 1.0671 - val_accuracy: 0.6352
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0127 - accuracy: 0.6462 - val_loss: 1.0099 - val_accuracy: 0.6855
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9365 - accuracy: 0.6659 - val_loss: 1.0487 - val_accuracy: 0.6226
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8893 - accuracy: 0.6777 - val_loss: 0.9132 - val_accuracy: 0.6792
Epoch 9/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7603 - accuracy: 0.7453 - val_loss: 0.8858 - val_accuracy: 0.6541
Epoch 10/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7143 - accuracy: 0.7508 - val_loss: 0.8616 - val_accuracy: 0.7107
Epoch 11/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6770 - accuracy: 0.7610 - val_loss: 0.8671 - val_accuracy: 0.6792
Epoch 12/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6527 - accuracy: 0.7791 - val_loss: 0.8306 - val_accuracy: 0.6855
Epoch 13/30
20/20 [==============================] - 1s 69ms/step - loss: 0.5751 - accuracy: 0.7972 - val_loss: 0.8096 - val_accuracy: 0.6981
Epoch 14/30
20/20 [==============================] - 1s 69ms/step - loss: 0.5228 - accuracy: 0.8176 - val_loss: 0.7647 - val_accuracy: 0.7044
Epoch 15/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4919 - accuracy: 0.8349 - val_loss: 0.7558 - val_accuracy: 0.7044
Epoch 16/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4499 - accuracy: 0.8365 - val_loss: 0.7454 - val_accuracy: 0.7107
Epoch 17/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4459 - accuracy: 0.8538 - val_loss: 0.8197 - val_accuracy: 0.6981
Epoch 18/30
20/20 [==============================] - 1s 71ms/step - loss: 0.4062 - accuracy: 0.8719 - val_loss: 0.8014 - val_accuracy: 0.7170
Epoch 00018: early stopping
Fold 1 - Test set accuracy: 75%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 115ms/step - loss: 2.2104 - accuracy: 0.1910 - val_loss: 2.0027 - val_accuracy: 0.2830
Epoch 2/30
20/20 [==============================] - 1s 71ms/step - loss: 1.7278 - accuracy: 0.3907 - val_loss: 1.5970 - val_accuracy: 0.4403
Epoch 3/30
20/20 [==============================] - 1s 70ms/step - loss: 1.4242 - accuracy: 0.5086 - val_loss: 1.3061 - val_accuracy: 0.5849
Epoch 4/30
20/20 [==============================] - 1s 71ms/step - loss: 1.2357 - accuracy: 0.5542 - val_loss: 1.2038 - val_accuracy: 0.5912
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.1489 - accuracy: 0.6069 - val_loss: 1.1462 - val_accuracy: 0.6352
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0298 - accuracy: 0.6423 - val_loss: 1.0677 - val_accuracy: 0.6352
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9731 - accuracy: 0.6525 - val_loss: 1.0843 - val_accuracy: 0.6415
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9155 - accuracy: 0.6832 - val_loss: 1.0528 - val_accuracy: 0.6226
Epoch 9/30
20/20 [==============================] - 1s 71ms/step - loss: 0.8551 - accuracy: 0.7020 - val_loss: 1.0038 - val_accuracy: 0.6164
Epoch 10/30
20/20 [==============================] - 1s 71ms/step - loss: 0.7759 - accuracy: 0.7264 - val_loss: 1.0014 - val_accuracy: 0.6541
Epoch 11/30
20/20 [==============================] - 1s 71ms/step - loss: 0.7634 - accuracy: 0.7358 - val_loss: 0.9108 - val_accuracy: 0.6667
Epoch 12/30
20/20 [==============================] - 1s 70ms/step - loss: 0.7161 - accuracy: 0.7500 - val_loss: 0.9250 - val_accuracy: 0.6541
Epoch 13/30
20/20 [==============================] - 1s 70ms/step - loss: 0.6366 - accuracy: 0.7822 - val_loss: 0.8571 - val_accuracy: 0.6730
Epoch 14/30
20/20 [==============================] - 1s 70ms/step - loss: 0.6251 - accuracy: 0.7932 - val_loss: 0.8336 - val_accuracy: 0.6792
Epoch 15/30
20/20 [==============================] - 1s 71ms/step - loss: 0.5942 - accuracy: 0.7862 - val_loss: 0.8176 - val_accuracy: 0.6792
Epoch 16/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5330 - accuracy: 0.8137 - val_loss: 0.8207 - val_accuracy: 0.6981
Epoch 17/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4797 - accuracy: 0.8333 - val_loss: 0.7992 - val_accuracy: 0.6981
Epoch 18/30
20/20 [==============================] - 1s 71ms/step - loss: 0.4652 - accuracy: 0.8436 - val_loss: 0.7965 - val_accuracy: 0.7170
Epoch 19/30
20/20 [==============================] - 1s 72ms/step - loss: 0.4416 - accuracy: 0.8443 - val_loss: 0.8287 - val_accuracy: 0.7233
Epoch 20/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4238 - accuracy: 0.8459 - val_loss: 0.8022 - val_accuracy: 0.6918
Epoch 00020: early stopping
Fold 2 - Test set accuracy: 72%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 104ms/step - loss: 2.1828 - accuracy: 0.1997 - val_loss: 1.9731 - val_accuracy: 0.2516
Epoch 2/30
20/20 [==============================] - 1s 72ms/step - loss: 1.7288 - accuracy: 0.3978 - val_loss: 1.5521 - val_accuracy: 0.4591
Epoch 3/30
20/20 [==============================] - 1s 71ms/step - loss: 1.4443 - accuracy: 0.4858 - val_loss: 1.3262 - val_accuracy: 0.5409
Epoch 4/30
20/20 [==============================] - 1s 71ms/step - loss: 1.2490 - accuracy: 0.5684 - val_loss: 1.1787 - val_accuracy: 0.6101
Epoch 5/30
20/20 [==============================] - 1s 71ms/step - loss: 1.1548 - accuracy: 0.5943 - val_loss: 1.1343 - val_accuracy: 0.6038
Epoch 6/30
20/20 [==============================] - 1s 71ms/step - loss: 1.0614 - accuracy: 0.6219 - val_loss: 1.1064 - val_accuracy: 0.5975
Epoch 7/30
20/20 [==============================] - 1s 71ms/step - loss: 0.9825 - accuracy: 0.6769 - val_loss: 1.0272 - val_accuracy: 0.6352
Epoch 8/30
20/20 [==============================] - 1s 71ms/step - loss: 0.9265 - accuracy: 0.6910 - val_loss: 0.9997 - val_accuracy: 0.6226
Epoch 9/30
20/20 [==============================] - 1s 71ms/step - loss: 0.8633 - accuracy: 0.7099 - val_loss: 0.9484 - val_accuracy: 0.6667
Epoch 10/30
20/20 [==============================] - 1s 71ms/step - loss: 0.8044 - accuracy: 0.7068 - val_loss: 0.9471 - val_accuracy: 0.6667
Epoch 11/30
20/20 [==============================] - 1s 71ms/step - loss: 0.7797 - accuracy: 0.7178 - val_loss: 0.9212 - val_accuracy: 0.6792
Epoch 12/30
20/20 [==============================] - 1s 71ms/step - loss: 0.7310 - accuracy: 0.7461 - val_loss: 0.9122 - val_accuracy: 0.6541
Epoch 13/30
20/20 [==============================] - 1s 72ms/step - loss: 0.6832 - accuracy: 0.7626 - val_loss: 0.8904 - val_accuracy: 0.6604
Epoch 14/30
20/20 [==============================] - 1s 71ms/step - loss: 0.6462 - accuracy: 0.7893 - val_loss: 0.8441 - val_accuracy: 0.6855
Epoch 15/30
20/20 [==============================] - 1s 71ms/step - loss: 0.6254 - accuracy: 0.7893 - val_loss: 0.8733 - val_accuracy: 0.6792
Epoch 16/30
20/20 [==============================] - 1s 71ms/step - loss: 0.5691 - accuracy: 0.8003 - val_loss: 0.8418 - val_accuracy: 0.6667
Epoch 17/30
20/20 [==============================] - 1s 72ms/step - loss: 0.5607 - accuracy: 0.8003 - val_loss: 0.8126 - val_accuracy: 0.6792
Epoch 18/30
20/20 [==============================] - 1s 71ms/step - loss: 0.5203 - accuracy: 0.8200 - val_loss: 0.8145 - val_accuracy: 0.7170
Epoch 19/30
20/20 [==============================] - 1s 69ms/step - loss: 0.5002 - accuracy: 0.8176 - val_loss: 0.7411 - val_accuracy: 0.7107
Epoch 20/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4710 - accuracy: 0.8443 - val_loss: 0.7660 - val_accuracy: 0.7233
Epoch 21/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4509 - accuracy: 0.8412 - val_loss: 0.7174 - val_accuracy: 0.7296
Epoch 22/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4171 - accuracy: 0.8522 - val_loss: 0.6950 - val_accuracy: 0.7421
Epoch 23/30
20/20 [==============================] - 1s 69ms/step - loss: 0.3930 - accuracy: 0.8679 - val_loss: 0.7059 - val_accuracy: 0.7421
Epoch 24/30
20/20 [==============================] - 1s 69ms/step - loss: 0.3810 - accuracy: 0.8742 - val_loss: 0.7672 - val_accuracy: 0.7107
Epoch 00024: early stopping
Fold 3 - Test set accuracy: 77%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 103ms/step - loss: 2.1744 - accuracy: 0.2115 - val_loss: 1.9100 - val_accuracy: 0.3774
Epoch 2/30
20/20 [==============================] - 1s 68ms/step - loss: 1.6785 - accuracy: 0.4347 - val_loss: 1.4666 - val_accuracy: 0.5220
Epoch 3/30
20/20 [==============================] - 1s 69ms/step - loss: 1.3598 - accuracy: 0.5464 - val_loss: 1.2481 - val_accuracy: 0.5975
Epoch 4/30
20/20 [==============================] - 1s 68ms/step - loss: 1.2032 - accuracy: 0.5778 - val_loss: 1.1586 - val_accuracy: 0.6352
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0644 - accuracy: 0.6376 - val_loss: 1.0648 - val_accuracy: 0.5975
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9989 - accuracy: 0.6722 - val_loss: 1.0490 - val_accuracy: 0.6101
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8896 - accuracy: 0.6832 - val_loss: 0.9542 - val_accuracy: 0.6164
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7981 - accuracy: 0.7311 - val_loss: 0.9181 - val_accuracy: 0.6478
Epoch 9/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7367 - accuracy: 0.7492 - val_loss: 0.8930 - val_accuracy: 0.6855
Epoch 10/30
20/20 [==============================] - 1s 68ms/step - loss: 0.7062 - accuracy: 0.7524 - val_loss: 0.8756 - val_accuracy: 0.6604
Epoch 11/30
20/20 [==============================] - 1s 74ms/step - loss: 0.6380 - accuracy: 0.7901 - val_loss: 0.8427 - val_accuracy: 0.6730
Epoch 12/30
20/20 [==============================] - 2s 79ms/step - loss: 0.5835 - accuracy: 0.7972 - val_loss: 0.8093 - val_accuracy: 0.7107
Epoch 13/30
20/20 [==============================] - 1s 69ms/step - loss: 0.5709 - accuracy: 0.8090 - val_loss: 0.7887 - val_accuracy: 0.7107
Epoch 14/30
20/20 [==============================] - 1s 69ms/step - loss: 0.5358 - accuracy: 0.8090 - val_loss: 0.7861 - val_accuracy: 0.6918
Epoch 15/30
20/20 [==============================] - 1s 68ms/step - loss: 0.4841 - accuracy: 0.8388 - val_loss: 0.7391 - val_accuracy: 0.7044
Epoch 16/30
20/20 [==============================] - 1s 71ms/step - loss: 0.4583 - accuracy: 0.8451 - val_loss: 0.8123 - val_accuracy: 0.7107
Epoch 17/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4287 - accuracy: 0.8601 - val_loss: 0.7758 - val_accuracy: 0.7044
Epoch 00017: early stopping
Fold 4 - Test set accuracy: 73%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 105ms/step - loss: 2.1792 - accuracy: 0.2013 - val_loss: 1.9718 - val_accuracy: 0.2704
Epoch 2/30
20/20 [==============================] - 1s 71ms/step - loss: 1.7024 - accuracy: 0.4009 - val_loss: 1.4991 - val_accuracy: 0.4717
Epoch 3/30
20/20 [==============================] - 1s 70ms/step - loss: 1.3906 - accuracy: 0.5157 - val_loss: 1.2859 - val_accuracy: 0.5535
Epoch 4/30
20/20 [==============================] - 1s 69ms/step - loss: 1.2066 - accuracy: 0.5637 - val_loss: 1.2309 - val_accuracy: 0.5912
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0987 - accuracy: 0.6313 - val_loss: 1.1799 - val_accuracy: 0.5912
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0010 - accuracy: 0.6509 - val_loss: 1.0653 - val_accuracy: 0.6038
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9100 - accuracy: 0.6942 - val_loss: 1.0720 - val_accuracy: 0.6226
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8097 - accuracy: 0.7233 - val_loss: 0.9690 - val_accuracy: 0.6415
Epoch 9/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7583 - accuracy: 0.7374 - val_loss: 0.8926 - val_accuracy: 0.6918
Epoch 10/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6931 - accuracy: 0.7586 - val_loss: 0.8494 - val_accuracy: 0.6981
Epoch 11/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6483 - accuracy: 0.7712 - val_loss: 0.8369 - val_accuracy: 0.6730
Epoch 12/30
20/20 [==============================] - 1s 69ms/step - loss: 0.5721 - accuracy: 0.8160 - val_loss: 0.7833 - val_accuracy: 0.6792
Epoch 13/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5152 - accuracy: 0.8215 - val_loss: 0.8218 - val_accuracy: 0.6918
Epoch 14/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4989 - accuracy: 0.8255 - val_loss: 0.7450 - val_accuracy: 0.7296
Epoch 15/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4560 - accuracy: 0.8601 - val_loss: 0.7650 - val_accuracy: 0.6981
Epoch 16/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4502 - accuracy: 0.8467 - val_loss: 0.7585 - val_accuracy: 0.6981
Epoch 00016: early stopping
Fold 5 - Test set accuracy: 74%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 105ms/step - loss: 2.1759 - accuracy: 0.2170 - val_loss: 1.9249 - val_accuracy: 0.3145
Epoch 2/30
20/20 [==============================] - 1s 70ms/step - loss: 1.6866 - accuracy: 0.4285 - val_loss: 1.4859 - val_accuracy: 0.4969
Epoch 3/30
20/20 [==============================] - 1s 70ms/step - loss: 1.4204 - accuracy: 0.5259 - val_loss: 1.3244 - val_accuracy: 0.5409
Epoch 4/30
20/20 [==============================] - 1s 70ms/step - loss: 1.2234 - accuracy: 0.5747 - val_loss: 1.1734 - val_accuracy: 0.6038
Epoch 5/30
20/20 [==============================] - 1s 70ms/step - loss: 1.1165 - accuracy: 0.6061 - val_loss: 1.1230 - val_accuracy: 0.5849
Epoch 6/30
20/20 [==============================] - 1s 70ms/step - loss: 1.0599 - accuracy: 0.6156 - val_loss: 1.0301 - val_accuracy: 0.5975
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9760 - accuracy: 0.6557 - val_loss: 1.0186 - val_accuracy: 0.5912
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8743 - accuracy: 0.6934 - val_loss: 0.9462 - val_accuracy: 0.6164
Epoch 9/30
20/20 [==============================] - 1s 70ms/step - loss: 0.8030 - accuracy: 0.7178 - val_loss: 0.8723 - val_accuracy: 0.6289
Epoch 10/30
20/20 [==============================] - 1s 71ms/step - loss: 0.7562 - accuracy: 0.7311 - val_loss: 0.8680 - val_accuracy: 0.6352
Epoch 11/30
20/20 [==============================] - 1s 70ms/step - loss: 0.7008 - accuracy: 0.7500 - val_loss: 0.8252 - val_accuracy: 0.6792
Epoch 12/30
20/20 [==============================] - 1s 70ms/step - loss: 0.6339 - accuracy: 0.7767 - val_loss: 0.7966 - val_accuracy: 0.6981
Epoch 13/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6229 - accuracy: 0.7830 - val_loss: 0.8777 - val_accuracy: 0.6289
Epoch 14/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5936 - accuracy: 0.7980 - val_loss: 0.7814 - val_accuracy: 0.6792
Epoch 15/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5565 - accuracy: 0.8027 - val_loss: 0.7599 - val_accuracy: 0.6918
Epoch 16/30
20/20 [==============================] - 1s 71ms/step - loss: 0.4792 - accuracy: 0.8333 - val_loss: 0.7078 - val_accuracy: 0.7044
Epoch 17/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4811 - accuracy: 0.8247 - val_loss: 0.6966 - val_accuracy: 0.7107
Epoch 18/30
20/20 [==============================] - 1s 68ms/step - loss: 0.4581 - accuracy: 0.8373 - val_loss: 0.6753 - val_accuracy: 0.7296
Epoch 19/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4206 - accuracy: 0.8569 - val_loss: 0.6988 - val_accuracy: 0.7233
Epoch 20/30
20/20 [==============================] - 1s 68ms/step - loss: 0.4113 - accuracy: 0.8671 - val_loss: 0.7712 - val_accuracy: 0.7233
Epoch 00020: early stopping
Fold 6 - Test set accuracy: 74%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 103ms/step - loss: 2.1738 - accuracy: 0.2146 - val_loss: 1.9392 - val_accuracy: 0.2956
Epoch 2/30
20/20 [==============================] - 1s 68ms/step - loss: 1.7313 - accuracy: 0.3750 - val_loss: 1.5685 - val_accuracy: 0.4465
Epoch 3/30
20/20 [==============================] - 1s 68ms/step - loss: 1.4110 - accuracy: 0.4874 - val_loss: 1.3355 - val_accuracy: 0.5472
Epoch 4/30
20/20 [==============================] - 1s 68ms/step - loss: 1.2664 - accuracy: 0.5590 - val_loss: 1.2067 - val_accuracy: 0.6038
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.1529 - accuracy: 0.5983 - val_loss: 1.1054 - val_accuracy: 0.6352
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0567 - accuracy: 0.6344 - val_loss: 1.0465 - val_accuracy: 0.6038
Epoch 7/30
20/20 [==============================] - 1s 68ms/step - loss: 0.9775 - accuracy: 0.6502 - val_loss: 1.0242 - val_accuracy: 0.6415
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9180 - accuracy: 0.6808 - val_loss: 0.9437 - val_accuracy: 0.6478
Epoch 9/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8636 - accuracy: 0.7028 - val_loss: 0.9125 - val_accuracy: 0.6289
Epoch 10/30
20/20 [==============================] - 1s 68ms/step - loss: 0.7838 - accuracy: 0.7217 - val_loss: 0.9118 - val_accuracy: 0.6415
Epoch 11/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6871 - accuracy: 0.7642 - val_loss: 0.8461 - val_accuracy: 0.6730
Epoch 12/30
20/20 [==============================] - 1s 71ms/step - loss: 0.6657 - accuracy: 0.7642 - val_loss: 0.8489 - val_accuracy: 0.6604
Epoch 13/30
20/20 [==============================] - 1s 68ms/step - loss: 0.6217 - accuracy: 0.7759 - val_loss: 0.8999 - val_accuracy: 0.6541
Epoch 00013: early stopping
Fold 7 - Test set accuracy: 76%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 105ms/step - loss: 2.1935 - accuracy: 0.1863 - val_loss: 1.9341 - val_accuracy: 0.3082
Epoch 2/30
20/20 [==============================] - 1s 69ms/step - loss: 1.6598 - accuracy: 0.4222 - val_loss: 1.4688 - val_accuracy: 0.4906
Epoch 3/30
20/20 [==============================] - 1s 70ms/step - loss: 1.3772 - accuracy: 0.5236 - val_loss: 1.2859 - val_accuracy: 0.5535
Epoch 4/30
20/20 [==============================] - 1s 69ms/step - loss: 1.2139 - accuracy: 0.5747 - val_loss: 1.1677 - val_accuracy: 0.6038
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0840 - accuracy: 0.6179 - val_loss: 1.1070 - val_accuracy: 0.5975
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0220 - accuracy: 0.6462 - val_loss: 1.0578 - val_accuracy: 0.6038
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9378 - accuracy: 0.6785 - val_loss: 0.9904 - val_accuracy: 0.6038
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8330 - accuracy: 0.7146 - val_loss: 0.9698 - val_accuracy: 0.6289
Epoch 9/30
20/20 [==============================] - 1s 71ms/step - loss: 0.8161 - accuracy: 0.7075 - val_loss: 0.9249 - val_accuracy: 0.6478
Epoch 10/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7411 - accuracy: 0.7453 - val_loss: 0.8680 - val_accuracy: 0.6730
Epoch 11/30
20/20 [==============================] - 1s 70ms/step - loss: 0.7050 - accuracy: 0.7547 - val_loss: 0.8521 - val_accuracy: 0.6415
Epoch 12/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6455 - accuracy: 0.7728 - val_loss: 0.8467 - val_accuracy: 0.6604
Epoch 13/30
20/20 [==============================] - 1s 71ms/step - loss: 0.5878 - accuracy: 0.7948 - val_loss: 0.8005 - val_accuracy: 0.6981
Epoch 14/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5634 - accuracy: 0.8129 - val_loss: 0.8215 - val_accuracy: 0.6792
Epoch 15/30
20/20 [==============================] - 1s 71ms/step - loss: 0.5107 - accuracy: 0.8255 - val_loss: 0.7736 - val_accuracy: 0.6981
Epoch 16/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4851 - accuracy: 0.8381 - val_loss: 0.7988 - val_accuracy: 0.6667
Epoch 17/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4471 - accuracy: 0.8381 - val_loss: 0.7709 - val_accuracy: 0.6855
Epoch 18/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4524 - accuracy: 0.8373 - val_loss: 0.7955 - val_accuracy: 0.7044
Epoch 19/30
20/20 [==============================] - 1s 69ms/step - loss: 0.4353 - accuracy: 0.8514 - val_loss: 0.8469 - val_accuracy: 0.6415
Epoch 00019: early stopping
Fold 8 - Test set accuracy: 74%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 110ms/step - loss: 2.1634 - accuracy: 0.2166 - val_loss: 1.8675 - val_accuracy: 0.3797
Epoch 2/30
20/20 [==============================] - 1s 71ms/step - loss: 1.6281 - accuracy: 0.4576 - val_loss: 1.4210 - val_accuracy: 0.5443
Epoch 3/30
20/20 [==============================] - 1s 70ms/step - loss: 1.3350 - accuracy: 0.5463 - val_loss: 1.2260 - val_accuracy: 0.5696
Epoch 4/30
20/20 [==============================] - 1s 69ms/step - loss: 1.1394 - accuracy: 0.6115 - val_loss: 1.1279 - val_accuracy: 0.6329
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.1003 - accuracy: 0.6311 - val_loss: 1.0919 - val_accuracy: 0.6329
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9755 - accuracy: 0.6797 - val_loss: 0.9770 - val_accuracy: 0.6646
Epoch 7/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8817 - accuracy: 0.7064 - val_loss: 0.9508 - val_accuracy: 0.6709
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.8592 - accuracy: 0.7017 - val_loss: 0.9522 - val_accuracy: 0.6519
Epoch 9/30
20/20 [==============================] - 1s 70ms/step - loss: 0.7603 - accuracy: 0.7316 - val_loss: 0.8871 - val_accuracy: 0.6709
Epoch 10/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7262 - accuracy: 0.7441 - val_loss: 0.8198 - val_accuracy: 0.6646
Epoch 11/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6515 - accuracy: 0.7653 - val_loss: 0.8375 - val_accuracy: 0.6582
Epoch 12/30
20/20 [==============================] - 1s 70ms/step - loss: 0.6124 - accuracy: 0.7936 - val_loss: 0.8045 - val_accuracy: 0.6835
Epoch 13/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5812 - accuracy: 0.8022 - val_loss: 0.8612 - val_accuracy: 0.6582
Epoch 14/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5643 - accuracy: 0.8030 - val_loss: 0.7961 - val_accuracy: 0.6835
Epoch 15/30
20/20 [==============================] - 1s 70ms/step - loss: 0.5217 - accuracy: 0.8305 - val_loss: 0.7709 - val_accuracy: 0.6646
Epoch 16/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4991 - accuracy: 0.8422 - val_loss: 0.8148 - val_accuracy: 0.7089
Epoch 17/30
20/20 [==============================] - 1s 70ms/step - loss: 0.4546 - accuracy: 0.8532 - val_loss: 0.7822 - val_accuracy: 0.6709
Epoch 00017: early stopping
Fold 9 - Test set accuracy: 74%
Pipeline Completed
Epoch 1/30
20/20 [==============================] - 2s 105ms/step - loss: 2.1615 - accuracy: 0.2272 - val_loss: 1.9324 - val_accuracy: 0.3899
Epoch 2/30
20/20 [==============================] - 1s 69ms/step - loss: 1.6822 - accuracy: 0.4206 - val_loss: 1.5435 - val_accuracy: 0.5220
Epoch 3/30
20/20 [==============================] - 1s 70ms/step - loss: 1.3788 - accuracy: 0.5369 - val_loss: 1.4093 - val_accuracy: 0.5472
Epoch 4/30
20/20 [==============================] - 1s 70ms/step - loss: 1.2330 - accuracy: 0.5605 - val_loss: 1.3205 - val_accuracy: 0.5535
Epoch 5/30
20/20 [==============================] - 1s 69ms/step - loss: 1.0571 - accuracy: 0.6431 - val_loss: 1.2469 - val_accuracy: 0.6038
Epoch 6/30
20/20 [==============================] - 1s 69ms/step - loss: 0.9649 - accuracy: 0.6690 - val_loss: 1.1347 - val_accuracy: 0.6164
Epoch 7/30
20/20 [==============================] - 1s 68ms/step - loss: 0.8670 - accuracy: 0.6942 - val_loss: 1.0736 - val_accuracy: 0.6352
Epoch 8/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7933 - accuracy: 0.7390 - val_loss: 1.0864 - val_accuracy: 0.6415
Epoch 9/30
20/20 [==============================] - 1s 69ms/step - loss: 0.7648 - accuracy: 0.7366 - val_loss: 1.0387 - val_accuracy: 0.6604
Epoch 10/30
20/20 [==============================] - 1s 69ms/step - loss: 0.6991 - accuracy: 0.7531 - val_loss: 1.0760 - val_accuracy: 0.6478
Epoch 11/30
20/20 [==============================] - 1s 68ms/step - loss: 0.6448 - accuracy: 0.7689 - val_loss: 1.0538 - val_accuracy: 0.6541
Epoch 00011: early stopping
Fold 10 - Test set accuracy: 68%
[0.75, 0.72, 0.77, 0.73, 0.74, 0.74, 0.76, 0.74, 0.74, 0.68]
mean score: 0.74
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Done
[0.75, 0.72, 0.77, 0.73, 0.74, 0.74, 0.76, 0.74, 0.74, 0.68]
mean score: 0.74
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

