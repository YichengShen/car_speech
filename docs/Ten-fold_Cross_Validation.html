---

title: 10-fold Cross Validation


keywords: fastai
sidebar: home_sidebar

summary: "Code for training is the same as Notebook 05."
description: "Code for training is the same as Notebook 05."
nb_path: "08_Ten-fold_Cross_Validation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 08_Ten-fold_Cross_Validation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">car_speech.fname_processing</span> <span class="kn">import</span> <span class="n">load_fnames</span>
<span class="kn">from</span> <span class="nn">car_speech.pipeline</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers.experimental</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">KFold</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Configuration">Configuration<a class="anchor-link" href="#Configuration"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DATASET_TYPE</span> <span class="o">=</span> <span class="s1">&#39;digits&#39;</span> <span class="c1"># &#39;digits&#39; or &#39;letters&#39; or &#39;mixed&#39;</span>
<span class="n">LEVEL_NAME</span> <span class="o">=</span> <span class="s1">&#39;IDL&#39;</span> <span class="c1"># &#39;IDL&#39; or &#39;35U&#39; or &#39;35D&#39; or &#39;55U&#39; or &#39;55D&#39;</span>

<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;digits&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)])</span>
    <span class="n">fname_str</span> <span class="o">=</span> <span class="s1">&#39;digit&#39;</span>
<span class="k">elif</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;letters&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>
    <span class="n">fname_str</span> <span class="o">=</span> <span class="s1">&#39;letter&#39;</span>
<span class="k">elif</span> <span class="n">DATASET_TYPE</span> <span class="o">==</span> <span class="s1">&#39;mixed&#39;</span><span class="p">:</span>
    <span class="n">label_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>
    <span class="n">fname_str</span> <span class="o">=</span> <span class="s1">&#39;mixed&#39;</span>
    
<span class="c1"># load classified filenames</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">load_fnames</span><span class="p">(</span><span class="s1">&#39;noise_levels/&#39;</span> <span class="o">+</span> <span class="n">fname_str</span> <span class="o">+</span> <span class="s1">&#39;_noise_levels/&#39;</span> <span class="o">+</span> <span class="n">LEVEL_NAME</span> <span class="o">+</span> <span class="s1">&#39;.data&#39;</span><span class="p">)</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of files:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">))</span>

<span class="c1"># shuffle</span>
<span class="n">shuffle</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>

<span class="n">fold_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">acc_per_fold</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>number of files: 1579
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loop-for-10-fold">Loop for 10-fold<a class="anchor-link" href="#Loop-for-10-fold"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beg_ratio</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">beg_ratio</span> <span class="o">&lt;</span> <span class="mf">0.9</span><span class="p">:</span>
    <span class="n">test_beg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">beg_ratio</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="n">test_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">beg_ratio</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">*</span><span class="n">num_samples</span><span class="p">)</span>
    
    <span class="n">fnames_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="n">test_beg</span><span class="p">:</span><span class="n">test_end</span><span class="p">]</span>
    
    <span class="n">val_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    <span class="k">del</span> <span class="n">fnames_copy</span><span class="p">[</span><span class="o">-</span><span class="n">val_len</span><span class="p">:]</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">fnames_copy</span>
    
    <span class="n">beg_ratio</span> <span class="o">+=</span> <span class="mf">0.1</span>
    
    <span class="n">train_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">train_files</span><span class="p">)</span>
    <span class="n">val_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">val_files</span><span class="p">)</span>
    <span class="n">test_files</span> <span class="o">=</span> <span class="n">shuffle_data</span><span class="p">(</span><span class="n">test_files</span><span class="p">)</span>
    

    <span class="c1"># Process data using the combined pipeline</span>
    <span class="n">spectrogram_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">train_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">spectrogram_ds</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">val_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="n">test_ds</span> <span class="o">=</span> <span class="n">preprocess_dataset</span><span class="p">(</span><span class="n">test_files</span><span class="p">,</span> <span class="n">DATASET_TYPE</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pipeline Completed&quot;</span><span class="p">)</span>
    
    <span class="c1"># batch</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    
    <span class="n">AUTOTUNE</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span>
    <span class="n">train_ds</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    <span class="n">val_ds</span> <span class="o">=</span> <span class="n">val_ds</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">AUTOTUNE</span><span class="p">)</span>
    
    <span class="c1"># model</span>
    <span class="k">for</span> <span class="n">spectrogram</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">spectrogram</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">#     print(&#39;Input shape:&#39;, input_shape)</span>
    <span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_strings</span><span class="p">)</span>

    <span class="n">norm_layer</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">Normalization</span><span class="p">()</span>
    <span class="n">norm_layer</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">spectrogram_ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">x</span><span class="p">))</span>

<span class="c1">#     model = models.Sequential([</span>
<span class="c1">#         layers.Input(shape=input_shape),</span>
<span class="c1">#         preprocessing.Resizing(32, 32), </span>
<span class="c1">#         norm_layer,</span>
<span class="c1">#         layers.Conv2D(32, 3, activation=&#39;relu&#39;),</span>
<span class="c1">#         layers.Conv2D(64, 3, activation=&#39;relu&#39;),</span>
<span class="c1">#         layers.MaxPooling2D(),</span>
<span class="c1">#         layers.Dropout(0.25),</span>
<span class="c1">#         layers.Flatten(),</span>
<span class="c1">#         layers.Dense(128, activation=&#39;relu&#39;),</span>
<span class="c1">#         layers.Dropout(0.5),</span>
<span class="c1">#         layers.Dense(num_labels),</span>
<span class="c1">#     ])</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">),</span>
        <span class="n">preprocessing</span><span class="o">.</span><span class="n">Resizing</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> 
        <span class="n">norm_layer</span><span class="p">,</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_labels</span><span class="p">),</span>
    <span class="p">])</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
        <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span>
    <span class="p">)</span>
    
    <span class="c1"># Train</span>
    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">train_ds</span><span class="p">,</span> 
        <span class="n">validation_data</span><span class="o">=</span><span class="n">val_ds</span><span class="p">,</span>  
        <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">test_audio</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">audio</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">test_ds</span><span class="p">:</span>
        <span class="n">test_audio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        <span class="n">test_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

    <span class="n">test_audio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_audio</span><span class="p">)</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_audio</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">test_labels</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fold </span><span class="si">{</span><span class="n">fold_no</span><span class="si">}</span><span class="s1"> - Test set accuracy: </span><span class="si">{</span><span class="n">test_acc</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">acc_per_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">test_acc</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">fold_no</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 152ms/step - loss: 2.2803 - accuracy: 0.1399 - val_loss: 2.1643 - val_accuracy: 0.2484
Epoch 2/100
20/20 [==============================] - 2s 117ms/step - loss: 2.0911 - accuracy: 0.2704 - val_loss: 1.8543 - val_accuracy: 0.3949
Epoch 3/100
20/20 [==============================] - 2s 118ms/step - loss: 1.8991 - accuracy: 0.3391 - val_loss: 1.6914 - val_accuracy: 0.4650
Epoch 4/100
20/20 [==============================] - 2s 118ms/step - loss: 1.7020 - accuracy: 0.3992 - val_loss: 1.4192 - val_accuracy: 0.5287
Epoch 5/100
20/20 [==============================] - 2s 117ms/step - loss: 1.5736 - accuracy: 0.4261 - val_loss: 1.3367 - val_accuracy: 0.5159
Epoch 6/100
20/20 [==============================] - 2s 118ms/step - loss: 1.4691 - accuracy: 0.4711 - val_loss: 1.2528 - val_accuracy: 0.5669
Epoch 7/100
20/20 [==============================] - 2s 120ms/step - loss: 1.3650 - accuracy: 0.5130 - val_loss: 1.2152 - val_accuracy: 0.5924
Epoch 8/100
20/20 [==============================] - 2s 116ms/step - loss: 1.2674 - accuracy: 0.5589 - val_loss: 1.0654 - val_accuracy: 0.6369
Epoch 9/100
20/20 [==============================] - 2s 117ms/step - loss: 1.1862 - accuracy: 0.5652 - val_loss: 1.0445 - val_accuracy: 0.6688
Epoch 10/100
20/20 [==============================] - 2s 117ms/step - loss: 1.2103 - accuracy: 0.5802 - val_loss: 1.0053 - val_accuracy: 0.6433
Epoch 11/100
20/20 [==============================] - 2s 116ms/step - loss: 1.0456 - accuracy: 0.6403 - val_loss: 0.8671 - val_accuracy: 0.6688
Epoch 12/100
20/20 [==============================] - 2s 117ms/step - loss: 1.0315 - accuracy: 0.6451 - val_loss: 0.8942 - val_accuracy: 0.7070
Epoch 13/100
20/20 [==============================] - 2s 120ms/step - loss: 0.9688 - accuracy: 0.6561 - val_loss: 0.8971 - val_accuracy: 0.7452
Epoch 14/100
20/20 [==============================] - 2s 117ms/step - loss: 0.9272 - accuracy: 0.6735 - val_loss: 0.7659 - val_accuracy: 0.7325
Epoch 15/100
20/20 [==============================] - 2s 118ms/step - loss: 0.8323 - accuracy: 0.7194 - val_loss: 0.7844 - val_accuracy: 0.7771
Epoch 16/100
20/20 [==============================] - 2s 118ms/step - loss: 0.7752 - accuracy: 0.7447 - val_loss: 0.7673 - val_accuracy: 0.7898
Epoch 17/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6906 - accuracy: 0.7470 - val_loss: 0.7192 - val_accuracy: 0.8025
Epoch 18/100
20/20 [==============================] - 2s 117ms/step - loss: 0.7375 - accuracy: 0.7439 - val_loss: 0.6604 - val_accuracy: 0.8089
Epoch 19/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6612 - accuracy: 0.7763 - val_loss: 0.6137 - val_accuracy: 0.8089
Epoch 20/100
20/20 [==============================] - 2s 116ms/step - loss: 0.6406 - accuracy: 0.7755 - val_loss: 0.6864 - val_accuracy: 0.8153
Epoch 21/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6096 - accuracy: 0.7755 - val_loss: 0.6204 - val_accuracy: 0.8280
Epoch 22/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5710 - accuracy: 0.8016 - val_loss: 0.6616 - val_accuracy: 0.8089
Epoch 00022: early stopping
Fold 1 - Test set accuracy: 85%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 150ms/step - loss: 2.2798 - accuracy: 0.1378 - val_loss: 2.1187 - val_accuracy: 0.2278
Epoch 2/100
20/20 [==============================] - 2s 119ms/step - loss: 2.0248 - accuracy: 0.2732 - val_loss: 1.7854 - val_accuracy: 0.4177
Epoch 3/100
20/20 [==============================] - 2s 117ms/step - loss: 1.8781 - accuracy: 0.3056 - val_loss: 1.6815 - val_accuracy: 0.4367
Epoch 4/100
20/20 [==============================] - 2s 117ms/step - loss: 1.6594 - accuracy: 0.4109 - val_loss: 1.4402 - val_accuracy: 0.5000
Epoch 5/100
20/20 [==============================] - 2s 116ms/step - loss: 1.5383 - accuracy: 0.4568 - val_loss: 1.3269 - val_accuracy: 0.5380
Epoch 6/100
20/20 [==============================] - 2s 118ms/step - loss: 1.4912 - accuracy: 0.4743 - val_loss: 1.2998 - val_accuracy: 0.5443
Epoch 7/100
20/20 [==============================] - 2s 117ms/step - loss: 1.3752 - accuracy: 0.5020 - val_loss: 1.3743 - val_accuracy: 0.5190
Epoch 8/100
20/20 [==============================] - 2s 118ms/step - loss: 1.2831 - accuracy: 0.5321 - val_loss: 1.3366 - val_accuracy: 0.5000
Epoch 9/100
20/20 [==============================] - 2s 118ms/step - loss: 1.2087 - accuracy: 0.5804 - val_loss: 1.0886 - val_accuracy: 0.6139
Epoch 10/100
20/20 [==============================] - 2s 117ms/step - loss: 1.1495 - accuracy: 0.5914 - val_loss: 0.9493 - val_accuracy: 0.6835
Epoch 11/100
20/20 [==============================] - 2s 117ms/step - loss: 1.0249 - accuracy: 0.6231 - val_loss: 0.9083 - val_accuracy: 0.7215
Epoch 12/100
20/20 [==============================] - 2s 117ms/step - loss: 1.0026 - accuracy: 0.6200 - val_loss: 0.9870 - val_accuracy: 0.6899
Epoch 13/100
20/20 [==============================] - 2s 117ms/step - loss: 0.9417 - accuracy: 0.6603 - val_loss: 0.8404 - val_accuracy: 0.7278
Epoch 14/100
20/20 [==============================] - 2s 119ms/step - loss: 0.9129 - accuracy: 0.6849 - val_loss: 0.8497 - val_accuracy: 0.7405
Epoch 15/100
20/20 [==============================] - 2s 117ms/step - loss: 0.8345 - accuracy: 0.7078 - val_loss: 0.7865 - val_accuracy: 0.7595
Epoch 16/100
20/20 [==============================] - 2s 118ms/step - loss: 0.8429 - accuracy: 0.7118 - val_loss: 0.8420 - val_accuracy: 0.7089
Epoch 17/100
20/20 [==============================] - 2s 118ms/step - loss: 0.7672 - accuracy: 0.7110 - val_loss: 0.6831 - val_accuracy: 0.7468
Epoch 18/100
20/20 [==============================] - 2s 119ms/step - loss: 0.7581 - accuracy: 0.7371 - val_loss: 0.6821 - val_accuracy: 0.7785
Epoch 19/100
20/20 [==============================] - 2s 119ms/step - loss: 0.7070 - accuracy: 0.7498 - val_loss: 0.7156 - val_accuracy: 0.7785
Epoch 20/100
20/20 [==============================] - 2s 119ms/step - loss: 0.6437 - accuracy: 0.7728 - val_loss: 0.7110 - val_accuracy: 0.7975
Epoch 21/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6122 - accuracy: 0.7823 - val_loss: 0.6577 - val_accuracy: 0.8038
Epoch 22/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5466 - accuracy: 0.8021 - val_loss: 0.6042 - val_accuracy: 0.8291
Epoch 23/100
20/20 [==============================] - 2s 120ms/step - loss: 0.5606 - accuracy: 0.8005 - val_loss: 0.6316 - val_accuracy: 0.7975
Epoch 24/100
20/20 [==============================] - 2s 119ms/step - loss: 0.5411 - accuracy: 0.8084 - val_loss: 0.5782 - val_accuracy: 0.8354
Epoch 25/100
20/20 [==============================] - 2s 117ms/step - loss: 0.5269 - accuracy: 0.8139 - val_loss: 0.5804 - val_accuracy: 0.7975
Epoch 26/100
20/20 [==============================] - 2s 118ms/step - loss: 0.4996 - accuracy: 0.8226 - val_loss: 0.6283 - val_accuracy: 0.7848
Epoch 27/100
20/20 [==============================] - 2s 119ms/step - loss: 0.5003 - accuracy: 0.8211 - val_loss: 0.5630 - val_accuracy: 0.8228
Epoch 28/100
20/20 [==============================] - 2s 121ms/step - loss: 0.4707 - accuracy: 0.8314 - val_loss: 0.5375 - val_accuracy: 0.8354
Epoch 29/100
20/20 [==============================] - 2s 119ms/step - loss: 0.4391 - accuracy: 0.8464 - val_loss: 0.5362 - val_accuracy: 0.8354
Epoch 30/100
20/20 [==============================] - 2s 122ms/step - loss: 0.4202 - accuracy: 0.8591 - val_loss: 0.5069 - val_accuracy: 0.8291
Epoch 31/100
20/20 [==============================] - 2s 120ms/step - loss: 0.3909 - accuracy: 0.8662 - val_loss: 0.4938 - val_accuracy: 0.8418
Epoch 32/100
20/20 [==============================] - 2s 119ms/step - loss: 0.4286 - accuracy: 0.8599 - val_loss: 0.4901 - val_accuracy: 0.8354
Epoch 33/100
20/20 [==============================] - 2s 117ms/step - loss: 0.4030 - accuracy: 0.8654 - val_loss: 0.5629 - val_accuracy: 0.8101
Epoch 34/100
20/20 [==============================] - 2s 118ms/step - loss: 0.3969 - accuracy: 0.8606 - val_loss: 0.5645 - val_accuracy: 0.8354
Epoch 35/100
20/20 [==============================] - 2s 117ms/step - loss: 0.4069 - accuracy: 0.8511 - val_loss: 0.5186 - val_accuracy: 0.8354
Epoch 00035: early stopping
Fold 2 - Test set accuracy: 80%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 152ms/step - loss: 2.2550 - accuracy: 0.1528 - val_loss: 2.0730 - val_accuracy: 0.2848
Epoch 2/100
20/20 [==============================] - 2s 118ms/step - loss: 2.0378 - accuracy: 0.2716 - val_loss: 1.8138 - val_accuracy: 0.4051
Epoch 3/100
20/20 [==============================] - 2s 116ms/step - loss: 1.8148 - accuracy: 0.3698 - val_loss: 1.6272 - val_accuracy: 0.4494
Epoch 4/100
20/20 [==============================] - 2s 116ms/step - loss: 1.7015 - accuracy: 0.3990 - val_loss: 1.5255 - val_accuracy: 0.4810
Epoch 5/100
20/20 [==============================] - 2s 118ms/step - loss: 1.5410 - accuracy: 0.4561 - val_loss: 1.3791 - val_accuracy: 0.4747
Epoch 6/100
20/20 [==============================] - 2s 116ms/step - loss: 1.4558 - accuracy: 0.4687 - val_loss: 1.2917 - val_accuracy: 0.5696
Epoch 7/100
20/20 [==============================] - 2s 118ms/step - loss: 1.4017 - accuracy: 0.4996 - val_loss: 1.2308 - val_accuracy: 0.5886
Epoch 8/100
20/20 [==============================] - 2s 117ms/step - loss: 1.3373 - accuracy: 0.5202 - val_loss: 1.1970 - val_accuracy: 0.5886
Epoch 9/100
20/20 [==============================] - 2s 117ms/step - loss: 1.2497 - accuracy: 0.5527 - val_loss: 1.1390 - val_accuracy: 0.5886
Epoch 10/100
20/20 [==============================] - 2s 118ms/step - loss: 1.1361 - accuracy: 0.5978 - val_loss: 1.0057 - val_accuracy: 0.6646
Epoch 11/100
20/20 [==============================] - 2s 117ms/step - loss: 1.0369 - accuracy: 0.6271 - val_loss: 0.9106 - val_accuracy: 0.7025
Epoch 12/100
20/20 [==============================] - 2s 117ms/step - loss: 1.0212 - accuracy: 0.6556 - val_loss: 0.8568 - val_accuracy: 0.7025
Epoch 13/100
20/20 [==============================] - 2s 119ms/step - loss: 1.0361 - accuracy: 0.6302 - val_loss: 0.8786 - val_accuracy: 0.6709
Epoch 14/100
20/20 [==============================] - 2s 120ms/step - loss: 0.9602 - accuracy: 0.6524 - val_loss: 0.8392 - val_accuracy: 0.7215
Epoch 15/100
20/20 [==============================] - 2s 118ms/step - loss: 0.8685 - accuracy: 0.6817 - val_loss: 0.8658 - val_accuracy: 0.7089
Epoch 16/100
20/20 [==============================] - 3s 131ms/step - loss: 0.8546 - accuracy: 0.6983 - val_loss: 0.7599 - val_accuracy: 0.7405
Epoch 17/100
20/20 [==============================] - 2s 118ms/step - loss: 0.7678 - accuracy: 0.7348 - val_loss: 0.6851 - val_accuracy: 0.7658
Epoch 18/100
20/20 [==============================] - 2s 119ms/step - loss: 0.7586 - accuracy: 0.7340 - val_loss: 0.6975 - val_accuracy: 0.7722
Epoch 19/100
20/20 [==============================] - 2s 119ms/step - loss: 0.7284 - accuracy: 0.7530 - val_loss: 0.6607 - val_accuracy: 0.7595
Epoch 20/100
20/20 [==============================] - 2s 119ms/step - loss: 0.6901 - accuracy: 0.7601 - val_loss: 0.6924 - val_accuracy: 0.7595
Epoch 21/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6502 - accuracy: 0.7664 - val_loss: 0.6008 - val_accuracy: 0.7975
Epoch 22/100
20/20 [==============================] - 2s 117ms/step - loss: 0.6194 - accuracy: 0.7862 - val_loss: 0.5916 - val_accuracy: 0.7595
Epoch 23/100
20/20 [==============================] - 2s 117ms/step - loss: 0.6256 - accuracy: 0.7680 - val_loss: 0.6381 - val_accuracy: 0.7911
Epoch 24/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5969 - accuracy: 0.7894 - val_loss: 0.6819 - val_accuracy: 0.7722
Epoch 25/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5523 - accuracy: 0.8124 - val_loss: 0.5531 - val_accuracy: 0.7785
Epoch 26/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5126 - accuracy: 0.8298 - val_loss: 0.5708 - val_accuracy: 0.7911
Epoch 27/100
20/20 [==============================] - 2s 118ms/step - loss: 0.4882 - accuracy: 0.8226 - val_loss: 0.4978 - val_accuracy: 0.8228
Epoch 28/100
20/20 [==============================] - 2s 117ms/step - loss: 0.4770 - accuracy: 0.8337 - val_loss: 0.6299 - val_accuracy: 0.7911
Epoch 29/100
20/20 [==============================] - 2s 118ms/step - loss: 0.4622 - accuracy: 0.8424 - val_loss: 0.5444 - val_accuracy: 0.8291
Epoch 30/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5272 - accuracy: 0.8155 - val_loss: 0.4996 - val_accuracy: 0.8101
Epoch 00030: early stopping
Fold 3 - Test set accuracy: 81%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 154ms/step - loss: 2.2687 - accuracy: 0.1401 - val_loss: 2.1334 - val_accuracy: 0.1835
Epoch 2/100
20/20 [==============================] - 3s 129ms/step - loss: 2.0389 - accuracy: 0.2660 - val_loss: 1.8056 - val_accuracy: 0.3354
Epoch 3/100
20/20 [==============================] - 2s 120ms/step - loss: 1.8358 - accuracy: 0.3555 - val_loss: 1.7319 - val_accuracy: 0.4177
Epoch 4/100
20/20 [==============================] - 3s 126ms/step - loss: 1.6888 - accuracy: 0.4054 - val_loss: 1.6188 - val_accuracy: 0.4241
Epoch 5/100
20/20 [==============================] - 2s 118ms/step - loss: 1.5884 - accuracy: 0.4236 - val_loss: 1.4761 - val_accuracy: 0.5000
Epoch 6/100
20/20 [==============================] - 2s 120ms/step - loss: 1.4467 - accuracy: 0.4719 - val_loss: 1.3400 - val_accuracy: 0.5253
Epoch 7/100
20/20 [==============================] - 2s 119ms/step - loss: 1.3703 - accuracy: 0.5123 - val_loss: 1.1789 - val_accuracy: 0.5886
Epoch 8/100
20/20 [==============================] - 3s 127ms/step - loss: 1.3076 - accuracy: 0.5424 - val_loss: 1.1594 - val_accuracy: 0.5759
Epoch 9/100
20/20 [==============================] - 2s 123ms/step - loss: 1.2339 - accuracy: 0.5558 - val_loss: 1.0938 - val_accuracy: 0.5949
Epoch 10/100
20/20 [==============================] - 2s 120ms/step - loss: 1.1644 - accuracy: 0.5772 - val_loss: 0.9551 - val_accuracy: 0.6899
Epoch 11/100
20/20 [==============================] - 2s 125ms/step - loss: 1.1152 - accuracy: 0.6025 - val_loss: 1.0525 - val_accuracy: 0.6392
Epoch 12/100
20/20 [==============================] - 2s 120ms/step - loss: 1.0518 - accuracy: 0.6192 - val_loss: 0.8922 - val_accuracy: 0.6835
Epoch 13/100
20/20 [==============================] - 2s 121ms/step - loss: 0.9634 - accuracy: 0.6580 - val_loss: 0.8658 - val_accuracy: 0.7215
Epoch 14/100
20/20 [==============================] - 2s 118ms/step - loss: 0.9096 - accuracy: 0.6690 - val_loss: 0.8393 - val_accuracy: 0.7468
Epoch 15/100
20/20 [==============================] - 2s 119ms/step - loss: 0.8750 - accuracy: 0.6809 - val_loss: 0.7850 - val_accuracy: 0.7152
Epoch 16/100
20/20 [==============================] - 2s 117ms/step - loss: 0.8284 - accuracy: 0.7039 - val_loss: 0.7448 - val_accuracy: 0.7468
Epoch 17/100
20/20 [==============================] - 2s 118ms/step - loss: 0.7741 - accuracy: 0.7181 - val_loss: 0.7438 - val_accuracy: 0.7342
Epoch 18/100
20/20 [==============================] - 2s 118ms/step - loss: 0.7193 - accuracy: 0.7546 - val_loss: 0.7334 - val_accuracy: 0.7468
Epoch 19/100
20/20 [==============================] - 2s 118ms/step - loss: 0.7119 - accuracy: 0.7466 - val_loss: 0.7355 - val_accuracy: 0.7722
Epoch 20/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6766 - accuracy: 0.7593 - val_loss: 0.6590 - val_accuracy: 0.7785
Epoch 21/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6243 - accuracy: 0.7672 - val_loss: 0.6265 - val_accuracy: 0.7848
Epoch 22/100
20/20 [==============================] - 2s 118ms/step - loss: 0.6050 - accuracy: 0.7973 - val_loss: 0.6080 - val_accuracy: 0.8228
Epoch 23/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5703 - accuracy: 0.8052 - val_loss: 0.5679 - val_accuracy: 0.8101
Epoch 24/100
20/20 [==============================] - 2s 118ms/step - loss: 0.5310 - accuracy: 0.8155 - val_loss: 0.6065 - val_accuracy: 0.7848
Epoch 25/100
20/20 [==============================] - 3s 135ms/step - loss: 0.5089 - accuracy: 0.8298 - val_loss: 0.6049 - val_accuracy: 0.7911
Epoch 26/100
20/20 [==============================] - 3s 125ms/step - loss: 0.5359 - accuracy: 0.8147 - val_loss: 0.6775 - val_accuracy: 0.8038
Epoch 00026: early stopping
Fold 4 - Test set accuracy: 78%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 4s 225ms/step - loss: 2.2890 - accuracy: 0.1330 - val_loss: 2.1687 - val_accuracy: 0.2342
Epoch 2/100
20/20 [==============================] - 3s 144ms/step - loss: 2.1217 - accuracy: 0.2272 - val_loss: 1.8278 - val_accuracy: 0.3671
Epoch 3/100
20/20 [==============================] - 3s 144ms/step - loss: 1.8386 - accuracy: 0.3365 - val_loss: 1.6445 - val_accuracy: 0.4620
Epoch 4/100
20/20 [==============================] - 3s 139ms/step - loss: 1.6806 - accuracy: 0.3721 - val_loss: 1.4846 - val_accuracy: 0.5063
Epoch 5/100
20/20 [==============================] - 3s 132ms/step - loss: 1.5435 - accuracy: 0.4466 - val_loss: 1.3730 - val_accuracy: 0.5316
Epoch 6/100
20/20 [==============================] - 3s 145ms/step - loss: 1.3937 - accuracy: 0.4893 - val_loss: 1.2425 - val_accuracy: 0.6013
Epoch 7/100
20/20 [==============================] - 3s 148ms/step - loss: 1.3888 - accuracy: 0.4988 - val_loss: 1.2301 - val_accuracy: 0.5759
Epoch 8/100
20/20 [==============================] - 3s 145ms/step - loss: 1.2513 - accuracy: 0.5527 - val_loss: 1.1100 - val_accuracy: 0.6392
Epoch 9/100
20/20 [==============================] - 3s 134ms/step - loss: 1.1803 - accuracy: 0.5788 - val_loss: 1.0682 - val_accuracy: 0.6329
Epoch 10/100
20/20 [==============================] - 3s 130ms/step - loss: 1.1227 - accuracy: 0.6144 - val_loss: 0.9739 - val_accuracy: 0.7278
Epoch 11/100
20/20 [==============================] - 3s 128ms/step - loss: 1.0410 - accuracy: 0.6128 - val_loss: 1.0226 - val_accuracy: 0.6899
Epoch 12/100
20/20 [==============================] - 3s 126ms/step - loss: 1.0035 - accuracy: 0.6358 - val_loss: 0.8119 - val_accuracy: 0.7342
Epoch 13/100
20/20 [==============================] - 2s 125ms/step - loss: 0.9390 - accuracy: 0.6746 - val_loss: 0.8196 - val_accuracy: 0.7405
Epoch 14/100
20/20 [==============================] - 3s 126ms/step - loss: 0.8777 - accuracy: 0.6873 - val_loss: 0.8078 - val_accuracy: 0.7595
Epoch 15/100
20/20 [==============================] - 3s 128ms/step - loss: 0.8219 - accuracy: 0.7110 - val_loss: 0.7534 - val_accuracy: 0.7532
Epoch 16/100
20/20 [==============================] - 3s 125ms/step - loss: 0.7973 - accuracy: 0.7070 - val_loss: 0.7462 - val_accuracy: 0.7785
Epoch 17/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7610 - accuracy: 0.7221 - val_loss: 0.6604 - val_accuracy: 0.8228
Epoch 18/100
20/20 [==============================] - 3s 125ms/step - loss: 0.7289 - accuracy: 0.7538 - val_loss: 0.6991 - val_accuracy: 0.7785
Epoch 19/100
20/20 [==============================] - 3s 127ms/step - loss: 0.6776 - accuracy: 0.7609 - val_loss: 0.6558 - val_accuracy: 0.8038
Epoch 20/100
20/20 [==============================] - 3s 127ms/step - loss: 0.6405 - accuracy: 0.7870 - val_loss: 0.5956 - val_accuracy: 0.7911
Epoch 21/100
20/20 [==============================] - 2s 124ms/step - loss: 0.6045 - accuracy: 0.7831 - val_loss: 0.6733 - val_accuracy: 0.7785
Epoch 22/100
20/20 [==============================] - 3s 125ms/step - loss: 0.5810 - accuracy: 0.7957 - val_loss: 0.6251 - val_accuracy: 0.7975
Epoch 23/100
20/20 [==============================] - 3s 127ms/step - loss: 0.5641 - accuracy: 0.8068 - val_loss: 0.6148 - val_accuracy: 0.8291
Epoch 00023: early stopping
Fold 5 - Test set accuracy: 84%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 163ms/step - loss: 2.2725 - accuracy: 0.1409 - val_loss: 2.1291 - val_accuracy: 0.2468
Epoch 2/100
20/20 [==============================] - 3s 126ms/step - loss: 2.0659 - accuracy: 0.2589 - val_loss: 1.7504 - val_accuracy: 0.3861
Epoch 3/100
20/20 [==============================] - 2s 124ms/step - loss: 1.8865 - accuracy: 0.3302 - val_loss: 1.6055 - val_accuracy: 0.4557
Epoch 4/100
20/20 [==============================] - 3s 126ms/step - loss: 1.7146 - accuracy: 0.3919 - val_loss: 1.4701 - val_accuracy: 0.5127
Epoch 5/100
20/20 [==============================] - 2s 124ms/step - loss: 1.6197 - accuracy: 0.4268 - val_loss: 1.4300 - val_accuracy: 0.5316
Epoch 6/100
20/20 [==============================] - 3s 129ms/step - loss: 1.4954 - accuracy: 0.4885 - val_loss: 1.3082 - val_accuracy: 0.5443
Epoch 7/100
20/20 [==============================] - 3s 127ms/step - loss: 1.4448 - accuracy: 0.4901 - val_loss: 1.1489 - val_accuracy: 0.6013
Epoch 8/100
20/20 [==============================] - 3s 126ms/step - loss: 1.3031 - accuracy: 0.5257 - val_loss: 1.0684 - val_accuracy: 0.6519
Epoch 9/100
20/20 [==============================] - 3s 126ms/step - loss: 1.2426 - accuracy: 0.5629 - val_loss: 1.0789 - val_accuracy: 0.6329
Epoch 10/100
20/20 [==============================] - 3s 127ms/step - loss: 1.1807 - accuracy: 0.5883 - val_loss: 0.9495 - val_accuracy: 0.7215
Epoch 11/100
20/20 [==============================] - 3s 126ms/step - loss: 1.1130 - accuracy: 0.6105 - val_loss: 0.8492 - val_accuracy: 0.7342
Epoch 12/100
20/20 [==============================] - 2s 124ms/step - loss: 1.0117 - accuracy: 0.6390 - val_loss: 0.8553 - val_accuracy: 0.7215
Epoch 13/100
20/20 [==============================] - 3s 126ms/step - loss: 0.9783 - accuracy: 0.6453 - val_loss: 0.8325 - val_accuracy: 0.7215
Epoch 14/100
20/20 [==============================] - 3s 127ms/step - loss: 0.9170 - accuracy: 0.6825 - val_loss: 0.7026 - val_accuracy: 0.7975
Epoch 15/100
20/20 [==============================] - 3s 128ms/step - loss: 0.8634 - accuracy: 0.6896 - val_loss: 0.6875 - val_accuracy: 0.7785
Epoch 16/100
20/20 [==============================] - 2s 125ms/step - loss: 0.7624 - accuracy: 0.7308 - val_loss: 0.6614 - val_accuracy: 0.7785
Epoch 17/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7738 - accuracy: 0.7165 - val_loss: 0.6891 - val_accuracy: 0.7848
Epoch 18/100
20/20 [==============================] - 3s 129ms/step - loss: 0.6855 - accuracy: 0.7490 - val_loss: 0.6142 - val_accuracy: 0.8101
Epoch 19/100
20/20 [==============================] - 3s 128ms/step - loss: 0.6944 - accuracy: 0.7546 - val_loss: 0.6173 - val_accuracy: 0.7785
Epoch 20/100
20/20 [==============================] - 3s 126ms/step - loss: 0.6324 - accuracy: 0.7704 - val_loss: 0.5930 - val_accuracy: 0.7975
Epoch 21/100
20/20 [==============================] - 3s 126ms/step - loss: 0.6114 - accuracy: 0.7815 - val_loss: 0.6429 - val_accuracy: 0.8101
Epoch 22/100
20/20 [==============================] - 3s 127ms/step - loss: 0.6409 - accuracy: 0.7862 - val_loss: 0.5931 - val_accuracy: 0.8291
Epoch 23/100
20/20 [==============================] - 3s 127ms/step - loss: 0.5659 - accuracy: 0.7949 - val_loss: 0.5485 - val_accuracy: 0.8101
Epoch 24/100
20/20 [==============================] - 3s 127ms/step - loss: 0.5373 - accuracy: 0.8131 - val_loss: 0.6558 - val_accuracy: 0.8291
Epoch 25/100
20/20 [==============================] - 3s 126ms/step - loss: 0.5602 - accuracy: 0.8219 - val_loss: 0.5842 - val_accuracy: 0.8228
Epoch 26/100
20/20 [==============================] - 3s 129ms/step - loss: 0.5414 - accuracy: 0.8290 - val_loss: 0.6171 - val_accuracy: 0.8165
Epoch 00026: early stopping
Fold 6 - Test set accuracy: 85%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 166ms/step - loss: 2.2608 - accuracy: 0.1481 - val_loss: 2.0933 - val_accuracy: 0.2848
Epoch 2/100
20/20 [==============================] - 3s 131ms/step - loss: 2.0205 - accuracy: 0.2922 - val_loss: 1.7594 - val_accuracy: 0.4241
Epoch 3/100
20/20 [==============================] - 3s 126ms/step - loss: 1.8270 - accuracy: 0.3420 - val_loss: 1.5817 - val_accuracy: 0.5063
Epoch 4/100
20/20 [==============================] - 3s 127ms/step - loss: 1.6698 - accuracy: 0.4093 - val_loss: 1.4078 - val_accuracy: 0.5443
Epoch 5/100
20/20 [==============================] - 3s 129ms/step - loss: 1.5122 - accuracy: 0.4561 - val_loss: 1.2880 - val_accuracy: 0.5633
Epoch 6/100
20/20 [==============================] - 3s 126ms/step - loss: 1.4206 - accuracy: 0.4917 - val_loss: 1.1505 - val_accuracy: 0.6582
Epoch 7/100
20/20 [==============================] - 3s 125ms/step - loss: 1.3132 - accuracy: 0.5067 - val_loss: 1.1402 - val_accuracy: 0.6329
Epoch 8/100
20/20 [==============================] - 3s 125ms/step - loss: 1.2541 - accuracy: 0.5408 - val_loss: 1.0591 - val_accuracy: 0.6266
Epoch 9/100
20/20 [==============================] - 2s 125ms/step - loss: 1.1688 - accuracy: 0.5827 - val_loss: 1.0191 - val_accuracy: 0.6582
Epoch 10/100
20/20 [==============================] - 3s 128ms/step - loss: 1.1239 - accuracy: 0.5962 - val_loss: 1.0732 - val_accuracy: 0.5949
Epoch 11/100
20/20 [==============================] - 2s 124ms/step - loss: 1.0783 - accuracy: 0.6168 - val_loss: 0.9450 - val_accuracy: 0.6772
Epoch 12/100
20/20 [==============================] - 2s 125ms/step - loss: 1.0155 - accuracy: 0.6421 - val_loss: 0.8566 - val_accuracy: 0.7405
Epoch 13/100
20/20 [==============================] - 2s 124ms/step - loss: 0.9486 - accuracy: 0.6572 - val_loss: 0.8191 - val_accuracy: 0.7468
Epoch 14/100
20/20 [==============================] - 3s 126ms/step - loss: 0.9040 - accuracy: 0.6880 - val_loss: 0.7354 - val_accuracy: 0.7658
Epoch 15/100
20/20 [==============================] - 2s 125ms/step - loss: 0.8446 - accuracy: 0.7102 - val_loss: 0.7565 - val_accuracy: 0.7342
Epoch 16/100
20/20 [==============================] - 3s 127ms/step - loss: 0.7944 - accuracy: 0.7253 - val_loss: 0.7199 - val_accuracy: 0.7278
Epoch 17/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7910 - accuracy: 0.7070 - val_loss: 0.6879 - val_accuracy: 0.7658
Epoch 18/100
20/20 [==============================] - 3s 129ms/step - loss: 0.7420 - accuracy: 0.7435 - val_loss: 0.6615 - val_accuracy: 0.7785
Epoch 19/100
20/20 [==============================] - 3s 128ms/step - loss: 0.6988 - accuracy: 0.7633 - val_loss: 0.6603 - val_accuracy: 0.7785
Epoch 20/100
20/20 [==============================] - 3s 125ms/step - loss: 0.6702 - accuracy: 0.7569 - val_loss: 0.6225 - val_accuracy: 0.7975
Epoch 21/100
20/20 [==============================] - 3s 127ms/step - loss: 0.6642 - accuracy: 0.7664 - val_loss: 0.6433 - val_accuracy: 0.7785
Epoch 22/100
20/20 [==============================] - 3s 125ms/step - loss: 0.6092 - accuracy: 0.7838 - val_loss: 0.6050 - val_accuracy: 0.7848
Epoch 23/100
20/20 [==============================] - 3s 127ms/step - loss: 0.5554 - accuracy: 0.8013 - val_loss: 0.6121 - val_accuracy: 0.7848
Epoch 24/100
20/20 [==============================] - 3s 125ms/step - loss: 0.5553 - accuracy: 0.7981 - val_loss: 0.5671 - val_accuracy: 0.7911
Epoch 25/100
20/20 [==============================] - 3s 128ms/step - loss: 0.5345 - accuracy: 0.8147 - val_loss: 0.5778 - val_accuracy: 0.8038
Epoch 26/100
20/20 [==============================] - 3s 125ms/step - loss: 0.5184 - accuracy: 0.8179 - val_loss: 0.6366 - val_accuracy: 0.7722
Epoch 27/100
20/20 [==============================] - 3s 126ms/step - loss: 0.4827 - accuracy: 0.8377 - val_loss: 0.5237 - val_accuracy: 0.7848
Epoch 28/100
20/20 [==============================] - 3s 126ms/step - loss: 0.4635 - accuracy: 0.8369 - val_loss: 0.5254 - val_accuracy: 0.8038
Epoch 29/100
20/20 [==============================] - 3s 127ms/step - loss: 0.4634 - accuracy: 0.8321 - val_loss: 0.4983 - val_accuracy: 0.8165
Epoch 30/100
20/20 [==============================] - 2s 125ms/step - loss: 0.4435 - accuracy: 0.8511 - val_loss: 0.5046 - val_accuracy: 0.7975
Epoch 31/100
20/20 [==============================] - 3s 125ms/step - loss: 0.4207 - accuracy: 0.8543 - val_loss: 0.5121 - val_accuracy: 0.8165
Epoch 32/100
20/20 [==============================] - 3s 127ms/step - loss: 0.3980 - accuracy: 0.8638 - val_loss: 0.5086 - val_accuracy: 0.8354
Epoch 00032: early stopping
Fold 7 - Test set accuracy: 83%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 165ms/step - loss: 2.2673 - accuracy: 0.1417 - val_loss: 2.1127 - val_accuracy: 0.2785
Epoch 2/100
20/20 [==============================] - 3s 127ms/step - loss: 2.0881 - accuracy: 0.2668 - val_loss: 1.7974 - val_accuracy: 0.3987
Epoch 3/100
20/20 [==============================] - 2s 124ms/step - loss: 1.8580 - accuracy: 0.3500 - val_loss: 1.6405 - val_accuracy: 0.4747
Epoch 4/100
20/20 [==============================] - 3s 126ms/step - loss: 1.7256 - accuracy: 0.3856 - val_loss: 1.5204 - val_accuracy: 0.5063
Epoch 5/100
20/20 [==============================] - 3s 127ms/step - loss: 1.5498 - accuracy: 0.4489 - val_loss: 1.2904 - val_accuracy: 0.5506
Epoch 6/100
20/20 [==============================] - 3s 125ms/step - loss: 1.4756 - accuracy: 0.4759 - val_loss: 1.3037 - val_accuracy: 0.5633
Epoch 7/100
20/20 [==============================] - 3s 128ms/step - loss: 1.3839 - accuracy: 0.5107 - val_loss: 1.2247 - val_accuracy: 0.6329
Epoch 8/100
20/20 [==============================] - 3s 127ms/step - loss: 1.3024 - accuracy: 0.5376 - val_loss: 1.0592 - val_accuracy: 0.6962
Epoch 9/100
20/20 [==============================] - 3s 125ms/step - loss: 1.1843 - accuracy: 0.5812 - val_loss: 0.8981 - val_accuracy: 0.7342
Epoch 10/100
20/20 [==============================] - 2s 125ms/step - loss: 1.0961 - accuracy: 0.6152 - val_loss: 0.8423 - val_accuracy: 0.7911
Epoch 11/100
20/20 [==============================] - 3s 128ms/step - loss: 1.0191 - accuracy: 0.6524 - val_loss: 0.8061 - val_accuracy: 0.7722
Epoch 12/100
20/20 [==============================] - 3s 125ms/step - loss: 0.9841 - accuracy: 0.6714 - val_loss: 0.7501 - val_accuracy: 0.7722
Epoch 13/100
20/20 [==============================] - 3s 127ms/step - loss: 0.9541 - accuracy: 0.6651 - val_loss: 0.7102 - val_accuracy: 0.8228
Epoch 14/100
20/20 [==============================] - 3s 127ms/step - loss: 0.8581 - accuracy: 0.7086 - val_loss: 0.7640 - val_accuracy: 0.7785
Epoch 15/100
20/20 [==============================] - 3s 127ms/step - loss: 0.8867 - accuracy: 0.7094 - val_loss: 0.8839 - val_accuracy: 0.7405
Epoch 16/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7783 - accuracy: 0.7308 - val_loss: 0.6811 - val_accuracy: 0.7848
Epoch 17/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7411 - accuracy: 0.7585 - val_loss: 0.7717 - val_accuracy: 0.7595
Epoch 18/100
20/20 [==============================] - 2s 125ms/step - loss: 0.7213 - accuracy: 0.7546 - val_loss: 0.6228 - val_accuracy: 0.7722
Epoch 19/100
20/20 [==============================] - 3s 130ms/step - loss: 0.6834 - accuracy: 0.7664 - val_loss: 0.6636 - val_accuracy: 0.8165
Epoch 20/100
20/20 [==============================] - 3s 127ms/step - loss: 0.6095 - accuracy: 0.7957 - val_loss: 0.5739 - val_accuracy: 0.7911
Epoch 21/100
20/20 [==============================] - 3s 130ms/step - loss: 0.5504 - accuracy: 0.8179 - val_loss: 0.5775 - val_accuracy: 0.8354
Epoch 22/100
20/20 [==============================] - 3s 125ms/step - loss: 0.5559 - accuracy: 0.8179 - val_loss: 0.6867 - val_accuracy: 0.8038
Epoch 23/100
20/20 [==============================] - 3s 126ms/step - loss: 0.5774 - accuracy: 0.7926 - val_loss: 0.6025 - val_accuracy: 0.8165
Epoch 00023: early stopping
Fold 8 - Test set accuracy: 77%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 165ms/step - loss: 2.2363 - accuracy: 0.1615 - val_loss: 2.0206 - val_accuracy: 0.3354
Epoch 2/100
20/20 [==============================] - 3s 131ms/step - loss: 1.9860 - accuracy: 0.2874 - val_loss: 1.7058 - val_accuracy: 0.3924
Epoch 3/100
20/20 [==============================] - 2s 124ms/step - loss: 1.8113 - accuracy: 0.3642 - val_loss: 1.5685 - val_accuracy: 0.4747
Epoch 4/100
20/20 [==============================] - 3s 125ms/step - loss: 1.6380 - accuracy: 0.3959 - val_loss: 1.4136 - val_accuracy: 0.5190
Epoch 5/100
20/20 [==============================] - 3s 127ms/step - loss: 1.5394 - accuracy: 0.4481 - val_loss: 1.3315 - val_accuracy: 0.6076
Epoch 6/100
20/20 [==============================] - 3s 127ms/step - loss: 1.4257 - accuracy: 0.4648 - val_loss: 1.1560 - val_accuracy: 0.6203
Epoch 7/100
20/20 [==============================] - 2s 124ms/step - loss: 1.2830 - accuracy: 0.5289 - val_loss: 1.1225 - val_accuracy: 0.6329
Epoch 8/100
20/20 [==============================] - 3s 125ms/step - loss: 1.2604 - accuracy: 0.5455 - val_loss: 1.0775 - val_accuracy: 0.6392
Epoch 9/100
20/20 [==============================] - 2s 124ms/step - loss: 1.1820 - accuracy: 0.5685 - val_loss: 0.9752 - val_accuracy: 0.6709
Epoch 10/100
20/20 [==============================] - 3s 129ms/step - loss: 1.1163 - accuracy: 0.5986 - val_loss: 0.9153 - val_accuracy: 0.6899
Epoch 11/100
20/20 [==============================] - 2s 124ms/step - loss: 1.0335 - accuracy: 0.6318 - val_loss: 0.8370 - val_accuracy: 0.6709
Epoch 12/100
20/20 [==============================] - 2s 124ms/step - loss: 0.9670 - accuracy: 0.6500 - val_loss: 0.8087 - val_accuracy: 0.7025
Epoch 13/100
20/20 [==============================] - 3s 126ms/step - loss: 0.9261 - accuracy: 0.6698 - val_loss: 0.8062 - val_accuracy: 0.7152
Epoch 14/100
20/20 [==============================] - 3s 126ms/step - loss: 0.8692 - accuracy: 0.6793 - val_loss: 0.7841 - val_accuracy: 0.6962
Epoch 15/100
20/20 [==============================] - 2s 124ms/step - loss: 0.8578 - accuracy: 0.7031 - val_loss: 0.6964 - val_accuracy: 0.7468
Epoch 16/100
20/20 [==============================] - 2s 124ms/step - loss: 0.7892 - accuracy: 0.7316 - val_loss: 0.6742 - val_accuracy: 0.7595
Epoch 17/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7168 - accuracy: 0.7553 - val_loss: 0.6966 - val_accuracy: 0.7911
Epoch 18/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7186 - accuracy: 0.7458 - val_loss: 0.6649 - val_accuracy: 0.7405
Epoch 19/100
20/20 [==============================] - 3s 125ms/step - loss: 0.6525 - accuracy: 0.7783 - val_loss: 0.6324 - val_accuracy: 0.8101
Epoch 20/100
20/20 [==============================] - 3s 127ms/step - loss: 0.6202 - accuracy: 0.7823 - val_loss: 0.6299 - val_accuracy: 0.7342
Epoch 21/100
20/20 [==============================] - 2s 124ms/step - loss: 0.5834 - accuracy: 0.8108 - val_loss: 0.5451 - val_accuracy: 0.8291
Epoch 22/100
20/20 [==============================] - 3s 128ms/step - loss: 0.5715 - accuracy: 0.8076 - val_loss: 0.6390 - val_accuracy: 0.7785
Epoch 23/100
20/20 [==============================] - 2s 124ms/step - loss: 0.5503 - accuracy: 0.8211 - val_loss: 0.5836 - val_accuracy: 0.7848
Epoch 24/100
20/20 [==============================] - 2s 124ms/step - loss: 0.5131 - accuracy: 0.8108 - val_loss: 0.6256 - val_accuracy: 0.7911
Epoch 00024: early stopping
Fold 9 - Test set accuracy: 80%
Pipeline Completed
Epoch 1/100
20/20 [==============================] - 3s 165ms/step - loss: 2.2754 - accuracy: 0.1368 - val_loss: 2.1234 - val_accuracy: 0.3503
Epoch 2/100
20/20 [==============================] - 3s 127ms/step - loss: 2.0357 - accuracy: 0.2783 - val_loss: 1.6520 - val_accuracy: 0.4268
Epoch 3/100
20/20 [==============================] - 3s 128ms/step - loss: 1.8341 - accuracy: 0.3708 - val_loss: 1.4922 - val_accuracy: 0.4586
Epoch 4/100
20/20 [==============================] - 3s 126ms/step - loss: 1.6992 - accuracy: 0.3897 - val_loss: 1.4154 - val_accuracy: 0.5096
Epoch 5/100
20/20 [==============================] - 2s 125ms/step - loss: 1.5844 - accuracy: 0.4419 - val_loss: 1.3100 - val_accuracy: 0.5541
Epoch 6/100
20/20 [==============================] - 3s 126ms/step - loss: 1.4347 - accuracy: 0.4798 - val_loss: 1.1784 - val_accuracy: 0.6242
Epoch 7/100
20/20 [==============================] - 3s 126ms/step - loss: 1.3380 - accuracy: 0.5202 - val_loss: 1.0347 - val_accuracy: 0.6178
Epoch 8/100
20/20 [==============================] - 3s 138ms/step - loss: 1.2736 - accuracy: 0.5470 - val_loss: 0.9876 - val_accuracy: 0.6561
Epoch 9/100
20/20 [==============================] - 3s 136ms/step - loss: 1.1782 - accuracy: 0.5763 - val_loss: 0.9030 - val_accuracy: 0.6879
Epoch 10/100
20/20 [==============================] - 3s 133ms/step - loss: 1.0791 - accuracy: 0.6134 - val_loss: 0.8603 - val_accuracy: 0.6752
Epoch 11/100
20/20 [==============================] - 3s 143ms/step - loss: 0.9794 - accuracy: 0.6577 - val_loss: 0.8124 - val_accuracy: 0.7134
Epoch 12/100
20/20 [==============================] - 3s 129ms/step - loss: 0.9313 - accuracy: 0.6664 - val_loss: 0.7511 - val_accuracy: 0.7389
Epoch 13/100
20/20 [==============================] - 3s 131ms/step - loss: 0.9442 - accuracy: 0.6617 - val_loss: 0.7836 - val_accuracy: 0.7134
Epoch 14/100
20/20 [==============================] - 3s 127ms/step - loss: 0.8500 - accuracy: 0.7099 - val_loss: 0.7424 - val_accuracy: 0.7197
Epoch 15/100
20/20 [==============================] - 3s 128ms/step - loss: 0.7543 - accuracy: 0.7289 - val_loss: 0.7562 - val_accuracy: 0.7134
Epoch 16/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7717 - accuracy: 0.7439 - val_loss: 0.6905 - val_accuracy: 0.7325
Epoch 17/100
20/20 [==============================] - 3s 126ms/step - loss: 0.7185 - accuracy: 0.7676 - val_loss: 0.6230 - val_accuracy: 0.7898
Epoch 18/100
20/20 [==============================] - 2s 125ms/step - loss: 0.6521 - accuracy: 0.7810 - val_loss: 0.6868 - val_accuracy: 0.7580
Epoch 19/100
20/20 [==============================] - 3s 126ms/step - loss: 0.6665 - accuracy: 0.7684 - val_loss: 0.5750 - val_accuracy: 0.8280
Epoch 20/100
20/20 [==============================] - 3s 126ms/step - loss: 0.6356 - accuracy: 0.7763 - val_loss: 0.5884 - val_accuracy: 0.7580
Epoch 21/100
20/20 [==============================] - 3s 126ms/step - loss: 0.6326 - accuracy: 0.7779 - val_loss: 0.5729 - val_accuracy: 0.7707
Epoch 22/100
20/20 [==============================] - 3s 140ms/step - loss: 0.5652 - accuracy: 0.8079 - val_loss: 0.5970 - val_accuracy: 0.7771
Epoch 23/100
20/20 [==============================] - 3s 130ms/step - loss: 0.5836 - accuracy: 0.7992 - val_loss: 0.5639 - val_accuracy: 0.7898
Epoch 24/100
20/20 [==============================] - 3s 129ms/step - loss: 0.5005 - accuracy: 0.8300 - val_loss: 0.5498 - val_accuracy: 0.8025
Epoch 25/100
20/20 [==============================] - 3s 129ms/step - loss: 0.5251 - accuracy: 0.8253 - val_loss: 0.5521 - val_accuracy: 0.8089
Epoch 26/100
20/20 [==============================] - 3s 132ms/step - loss: 0.4861 - accuracy: 0.8292 - val_loss: 0.5195 - val_accuracy: 0.8025
Epoch 27/100
20/20 [==============================] - 3s 140ms/step - loss: 0.4437 - accuracy: 0.8451 - val_loss: 0.6485 - val_accuracy: 0.7707
Epoch 28/100
20/20 [==============================] - 3s 133ms/step - loss: 0.4113 - accuracy: 0.8458 - val_loss: 0.5822 - val_accuracy: 0.7771
Epoch 29/100
20/20 [==============================] - 3s 131ms/step - loss: 0.4238 - accuracy: 0.8466 - val_loss: 0.5173 - val_accuracy: 0.8280
Epoch 30/100
20/20 [==============================] - 3s 129ms/step - loss: 0.4089 - accuracy: 0.8427 - val_loss: 0.5295 - val_accuracy: 0.8153
Epoch 31/100
20/20 [==============================] - 3s 128ms/step - loss: 0.4030 - accuracy: 0.8601 - val_loss: 0.4289 - val_accuracy: 0.8217
Epoch 32/100
20/20 [==============================] - 3s 126ms/step - loss: 0.3824 - accuracy: 0.8688 - val_loss: 0.4915 - val_accuracy: 0.8217
Epoch 33/100
20/20 [==============================] - 3s 126ms/step - loss: 0.3835 - accuracy: 0.8727 - val_loss: 0.5281 - val_accuracy: 0.7898
Epoch 34/100
20/20 [==============================] - 3s 129ms/step - loss: 0.3648 - accuracy: 0.8743 - val_loss: 0.4892 - val_accuracy: 0.8280
Epoch 00034: early stopping
Fold 10 - Test set accuracy: 87%
[0.85, 0.8, 0.81, 0.78, 0.84, 0.85, 0.83, 0.77, 0.8, 0.87]
mean score: 0.82
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean score:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc_per_fold</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Done
[0.85, 0.8, 0.81, 0.78, 0.84, 0.85, 0.83, 0.77, 0.8, 0.87]
mean score: 0.82
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

